<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Results</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #232629;
    color: #7a7c7d;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #7a7c7d;  padding-left: 4px; }
div.sourceCode
  { color: #cfcfc2; background-color: #232629; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #cfcfc2; } /* Normal */
code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } /* Alert */
code span.an { color: #3f8058; } /* Annotation */
code span.at { color: #2980b9; } /* Attribute */
code span.bn { color: #f67400; } /* BaseN */
code span.bu { color: #7f8c8d; } /* BuiltIn */
code span.cf { color: #fdbc4b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #3daee9; } /* Char */
code span.cn { color: #27aeae; font-weight: bold; } /* Constant */
code span.co { color: #7a7c7d; } /* Comment */
code span.cv { color: #7f8c8d; } /* CommentVar */
code span.do { color: #a43340; } /* Documentation */
code span.dt { color: #2980b9; } /* DataType */
code span.dv { color: #f67400; } /* DecVal */
code span.er { color: #da4453; text-decoration: underline; } /* Error */
code span.ex { color: #0099ff; font-weight: bold; } /* Extension */
code span.fl { color: #f67400; } /* Float */
code span.fu { color: #8e44ad; } /* Function */
code span.im { color: #27ae60; } /* Import */
code span.in { color: #c45b00; } /* Information */
code span.kw { color: #cfcfc2; font-weight: bold; } /* Keyword */
code span.op { color: #cfcfc2; } /* Operator */
code span.ot { color: #27ae60; } /* Other */
code span.pp { color: #27ae60; } /* Preprocessor */
code span.re { color: #2980b9; background-color: #153042; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #da4453; } /* SpecialString */
code span.st { color: #f44f4f; } /* String */
code span.va { color: #27aeae; } /* Variable */
code span.vs { color: #da4453; } /* VerbatimString */
code span.wa { color: #da4453; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PredictOutbredCrossVar</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="PreprocessDataFiles.html">Preprocess Data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Fit MtBRRs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="fitMtBRRs.html">Run mixed models</a>
    </li>
    <li>
      <a href="getPMVarComps.html">Get VarComps</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Cross-validation study
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="predictCrossVars.html">Predict cross means and (co)variances</a>
    </li>
    <li>
      <a href="observedCrossVars.html">Observed means and (co)variances</a>
    </li>
    <li>
      <a href="predictionAccuracy.html">Prediction accuracy</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exploratory analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="predictUntestedCrosses.html">Predict untested crosses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Manuscript
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Results.html">Results</a>
    </li>
    <li>
      <a href="Figures.html">Figures</a>
    </li>
    <li>
      <a href="SupplementaryTables.html">Supplementary Tables</a>
    </li>
    <li>
      <a href="SupplementaryFigures.html">Supplementary Figures</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about.html">About</a>
    </li>
    <li>
      <a href="license.html">License</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/wolfemd/PredictOutbredCrossVar">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Results</h1>
<h4 class="date">2020-August-02</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-02-01
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>PredictOutbredCrossVar/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20191123code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20191123)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20191123code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20191123)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomwolfemdPredictOutbredCrossVartree883b1d4d2dae0efefd64e4c238477ce34df13895targetblank883b1d4a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/wolfemd/PredictOutbredCrossVar/tree/883b1d4d2dae0efefd64e4c238477ce34df13895" target="_blank">883b1d4</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomwolfemdPredictOutbredCrossVartree883b1d4d2dae0efefd64e4c238477ce34df13895targetblank883b1d4a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/wolfemd/PredictOutbredCrossVar/tree/883b1d4d2dae0efefd64e4c238477ce34df13895" target="_blank">883b1d4</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/.DS_Store
    Ignored:    code/.DS_Store
    Ignored:    data/.DS_Store
    Ignored:    output/.DS_Store
    Ignored:    output/crossRealizations/.DS_Store

Untracked files:
    Untracked:  .gitignore
    Untracked:  Icon
    Untracked:  PredictOutbredCrossVar.Rproj
    Untracked:  manuscript/
    Untracked:  output/crossPredictions/
    Untracked:  output/gblups_DirectionalDom_parentwise_crossVal_folds.rds
    Untracked:  output/gblups_geneticgroups.rds
    Untracked:  output/gblups_parentwise_crossVal_folds.rds

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/Results.Rmd</code>) and HTML (<code>docs/Results.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/883b1d4d2dae0efefd64e4c238477ce34df13895/analysis/Results.Rmd" target="_blank">883b1d4</a>
</td>
<td>
wolfemd
</td>
<td>
2021-02-01
</td>
<td>
Update the syntax highlighting and code-block formatting throughout for
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/analysis/Results.Rmd" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
<td>
Submission and GitHub ready version.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/wolfemd/PredictOutbredCrossVar/6a10c30fbe489268566e4b7568be67a4395c2080/docs/Results.html" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
<td>
Submission and GitHub ready version.
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr)</span></code></pre></div>
<div id="initial-summaries" class="section level1">
<h1>Initial summaries</h1>
<div id="summary-of-the-pedigree-and-germplasm" class="section level2">
<h2>Summary of the pedigree and germplasm</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ped<span class="ot">&lt;-</span><span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;ped_awc.rds&quot;</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ped <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sireID,damID) <span class="sc">%$%</span> <span class="fu">summary</span>(n)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   2.000   4.000   6.924  10.000  72.000 </code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ped <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(sireID,damID),<span class="at">names_to =</span> <span class="st">&quot;MaleOrFemale&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Parent&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Parent) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Ncontributions=</span><span class="fu">n</span>()) <span class="sc">%$%</span> <span class="fu">summary</span>(Ncontributions)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    4.00   16.00   30.61   36.00  256.00 </code></pre>
<p>There were 3199 comprising 462 families, derived from 209 parents in our pedigree. Parents were used an average of 31 (median 16, range 1-256) times as sire and/or dam in the pedigree. The mean family size was 7 (median 4, range 1-72).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>propHom<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTables.xlsx&quot;</span>),<span class="at">sheet =</span> <span class="st">&quot;TableS14&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(propHom<span class="sc">$</span>PropSNP_homozygous)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.7639  0.8254  0.8364  0.8363  0.8476  0.9273 </code></pre>
<p>The average proportion homozygous was 0.84 (range 0.76-0.93) across the 3199 pedigree members (computed over 33370 variable SNP; Table S14).</p>
<p>As expected for a population under recurrent selection, the homozygosity rate increases (though only fractionally) from the C0 (mean 0.826), C1 (0.835), C2 (0.838), C3 (0.839) (Figure S01).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>propHom <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;TMS13|TMS14|TMS15&quot;</span>, GID),<span class="st">&quot;GG (C0)&quot;</span>,<span class="cn">NA</span>),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Group=</span><span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS13&quot;</span>, GID),<span class="st">&quot;TMS13 (C1)&quot;</span>,Group),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Group=</span><span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS14&quot;</span>, GID),<span class="st">&quot;TMS14 (C2)&quot;</span>,Group),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Group=</span><span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS15&quot;</span>, GID),<span class="st">&quot;TMS15 (C3)&quot;</span>,Group)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Group) <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanPropHom=</span><span class="fu">round</span>(<span class="fu">mean</span>(PropSNP_homozygous),<span class="dv">3</span>))</span></code></pre></div>
<pre><code># A tibble: 4 x 2
  Group      meanPropHom
* &lt;chr&gt;            &lt;dbl&gt;
1 GG (C0)          0.826
2 TMS13 (C1)       0.835
3 TMS14 (C2)       0.838
4 TMS15 (C3)       0.839</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>propHom <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;TMS13|TMS14|TMS15&quot;</span>, GID),<span class="st">&quot;GG (C0)&quot;</span>,<span class="cn">NA</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Group=</span><span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS13&quot;</span>, GID),<span class="st">&quot;TMS13 (C1)&quot;</span>,Group),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Group=</span><span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS14&quot;</span>, GID),<span class="st">&quot;TMS14 (C2)&quot;</span>,Group),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Group=</span><span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS15&quot;</span>, GID),<span class="st">&quot;TMS15 (C3)&quot;</span>,Group)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Group,<span class="at">y=</span>PropSNP_homozygous,<span class="at">fill=</span>Group)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code></pre></div>
<p><img src="figure/Results.Rmd/figureS01-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-figureS01-1">
Past versions of figureS01-1.png
</button>
</p>
<div id="fig-figureS01-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/figureS01-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="summary-of-the-cross-validation-scheme" class="section level2">
<h2>Summary of the cross-validation scheme</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Table S2: Summary of cross-validation scheme</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>parentfold_summary<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTables.xlsx&quot;</span>),<span class="at">sheet =</span> <span class="st">&quot;TableS02&quot;</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>parentfold_summary <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_if</span>(is.numeric,<span class="sc">~</span><span class="fu">ceiling</span>(<span class="fu">mean</span>(.)))</span></code></pre></div>
<pre><code># A tibble: 1 x 4
  Ntestparents Ntrainset Ntestset NcrossesToPredict
         &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;             &lt;dbl&gt;
1           42      1833     1494               167</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>parentfold_summary <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_if</span>(is.numeric,<span class="sc">~</span><span class="fu">ceiling</span>(<span class="fu">min</span>(.))) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Value=</span><span class="st">&quot;Min&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(parentfold_summary <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarize_if</span>(is.numeric,<span class="sc">~</span><span class="fu">ceiling</span>(<span class="fu">max</span>(.))) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Value=</span><span class="st">&quot;Max&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 2 x 5
  Ntestparents Ntrainset Ntestset NcrossesToPredict Value
         &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;             &lt;dbl&gt; &lt;chr&gt;
1           41      1245     1003               143 Min  
2           42      2323     2081               204 Max  </code></pre>
<p>Across the 5 replications of 5-fold cross-validation the average number of samples was 1833 (range 1245-2323) for training sets and 1494 (range 1003-2081) for testing sets. The 25 training-testing pairs set-up an average of 167 (range 143-204) crosses-to-predict (Table S02).</p>
</div>
<div id="summary-of-the-blups-and-sel.-index" class="section level2">
<h2>Summary of the BLUPs and sel. index</h2>
<p>The correlation between phenotypic BLUPs for the two SI (stdSI and biofortSI; Table S01) was 0.43 (Figure S02). The correlation between DM and TCHART BLUPs, for which we had <em>a priori</em> expectations, was -0.29.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr);</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Selection weights -----------</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>indices<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTables.xlsx&quot;</span>),<span class="at">sheet =</span> <span class="st">&quot;TableS01&quot;</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># BLUPs -----------</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>blups<span class="ot">&lt;-</span><span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;blups_forawcdata.rds&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Trait,blups) <span class="sc">%&gt;%</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(blups) <span class="sc">%&gt;%</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Trait,germplasmName,BLUP) <span class="sc">%&gt;%</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Trait,BLUP) <span class="sc">%&gt;%</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(germplasmName,<span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">&quot;DM&quot;</span>,<span class="st">&quot;logFYLD&quot;</span>,<span class="st">&quot;MCMDS&quot;</span>,<span class="st">&quot;TCHART&quot;</span>)))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>blups <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(germplasmName,<span class="fu">all_of</span>(indices<span class="sc">$</span>Trait)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stdSI=</span>blups <span class="sc">%&gt;%</span> </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>           <span class="fu">select</span>(<span class="fu">all_of</span>(indices<span class="sc">$</span>Trait)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>           <span class="fu">as.data.frame</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>           <span class="fu">as.matrix</span>(.)<span class="sc">%*%</span>indices<span class="sc">$</span>stdSI,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">biofortSI=</span>blups <span class="sc">%&gt;%</span> </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>           <span class="fu">select</span>(<span class="fu">all_of</span>(indices<span class="sc">$</span>Trait)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>           <span class="fu">as.data.frame</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>           <span class="fu">as.matrix</span>(.)<span class="sc">%*%</span>indices<span class="sc">$</span>biofortSI)</span></code></pre></div>
<p>Correlations among phenotypic BLUPs (including Selection Indices)</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#```{r, fig.show=&quot;hold&quot;, out.width=&quot;50%&quot;}</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(blups,<span class="fu">aes</span>(<span class="at">x=</span>stdSI,<span class="at">y=</span>biofortSI)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.25</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>corMat<span class="ot">&lt;-</span><span class="fu">cor</span>(blups[,<span class="sc">-</span><span class="dv">1</span>],<span class="at">use =</span> <span class="st">&#39;pairwise.complete.obs&#39;</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> <span class="er">~</span>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(corMat, <span class="at">type =</span> <span class="st">&#39;lower&#39;</span>, <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">10</span>), <span class="at">diag =</span> T,<span class="at">addCoef.col =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">nrow=</span><span class="dv">1</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">0.35</span>,<span class="fl">0.65</span>)) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">&#39;Correlations among phenotypic BLUPs (including Selection Indices)&#39;</span>)</span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-9-1">
Past versions of unnamed-chunk-9-1.png
</button>
</p>
<div id="fig-unnamed-chunk-9-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-9-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="predictions-of-means" class="section level1">
<h1>Predictions of means</h1>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr);</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Table S6: Predicted and observed cross means </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># obsVSpredMeans&lt;-readxl::read_xlsx(here::here(&quot;manuscript&quot;,&quot;SupplementaryTables.xlsx&quot;),sheet = &quot;TableS06&quot;)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Table S10: Accuracies predicting the mean</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>accMeans<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTables.xlsx&quot;</span>),<span class="at">sheet =</span> <span class="st">&quot;TableS10&quot;</span>)</span></code></pre></div>
<div id="compare-validation-data-types" class="section level2">
<h2>Compare validation data types</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>accMeans <span class="sc">%&gt;%</span> <span class="co">#count(ValidationData,Model,VarComp)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(ValidationData,Accuracy) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>iidBLUPs,<span class="at">y=</span>GBLUPs,<span class="at">color=</span>predOf,<span class="at">shape=</span>Trait)) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">&#39;darkred&#39;</span>) <span class="sc">+</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>predOf<span class="sc">+</span>Model,<span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>()</span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-11-1">
Past versions of unnamed-chunk-11-1.png
</button>
</p>
<div id="fig-unnamed-chunk-11-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-11-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>accMeans <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(ValidationData,Accuracy) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>GBLUPs<span class="sc">-</span>iidBLUPs) <span class="sc">%$%</span> <span class="fu">summary</span>(diffAcc)</span></code></pre></div>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.06718  0.12992  0.17184  0.17368  0.21438  0.38530 </code></pre>
<p>Prediction accuracy using GBLUPs as validation give a nearly uniform higher correlation (mean 0.17 higher).</p>
<p>The figure below tries to show that accuracies per trait-fold-rep-Model do not re-rank much from iid-to-GBLUP validation data.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>forplot<span class="ot">&lt;-</span>accMeans <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pred=</span><span class="fu">paste0</span>(predOf,<span class="st">&quot;_&quot;</span>,Model), </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pred=</span><span class="fu">factor</span>(Pred,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;MeanBV_A&quot;</span>,<span class="st">&quot;MeanBV_DirDom&quot;</span>,<span class="st">&quot;MeanTGV_AD&quot;</span>,<span class="st">&quot;MeanTGV_DirDom&quot;</span>)),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait=</span><span class="fu">factor</span>(Trait,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;stdSI&quot;</span>,<span class="st">&quot;biofortSI&quot;</span>,<span class="st">&quot;DM&quot;</span>,<span class="st">&quot;logFYLD&quot;</span>,<span class="st">&quot;MCMDS&quot;</span>,<span class="st">&quot;TCHART&quot;</span>)),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">predOf=</span><span class="fu">factor</span>(predOf,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;MeanBV&quot;</span>,<span class="st">&quot;MeanTGV&quot;</span>)),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Model=</span><span class="fu">factor</span>(Model,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;AD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>)),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">RepFold=</span><span class="fu">paste0</span>(Repeat,<span class="st">&quot;_&quot;</span>,Fold,<span class="st">&quot;_&quot;</span>,Trait))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>forplot <span class="sc">%&gt;%</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>ValidationData,<span class="at">y=</span>Accuracy)) <span class="sc">+</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">data=</span>forplot,<span class="fu">aes</span>(<span class="at">fill=</span>ValidationData), <span class="at">alpha=</span><span class="fl">0.75</span>) <span class="sc">+</span> </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data=</span>forplot,<span class="fu">aes</span>(<span class="at">fill=</span>ValidationData), <span class="at">alpha=</span><span class="fl">0.85</span>, <span class="at">color=</span><span class="st">&#39;gray&#39;</span>,<span class="at">width=</span><span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>forplot,<span class="fu">aes</span>(<span class="at">group=</span>RepFold),<span class="at">color=</span><span class="st">&#39;darkred&#39;</span>,<span class="at">size=</span><span class="fl">0.6</span>,<span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>forplot,<span class="fu">aes</span>(<span class="at">color=</span>ValidationData, <span class="at">group=</span>RepFold),<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>) <span class="sc">+</span> </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">angle=</span><span class="dv">90</span>),</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Trait<span class="sc">~</span>Pred, <span class="at">scales=</span><span class="st">&#39;free_y&#39;</span>)</span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-13-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-13-1">
Past versions of unnamed-chunk-13-1.png
</button>
</p>
<div id="fig-unnamed-chunk-13-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-13-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Accuracies per trait-fold-rep-Model do not re-rank much from iid-to-GBLUP validation data&quot;</span>)</span></code></pre></div>
<pre><code>$title
[1] &quot;Accuracies per trait-fold-rep-Model do not re-rank much from iid-to-GBLUP validation data&quot;

attr(,&quot;class&quot;)
[1] &quot;labels&quot;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>accMeans <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pred=</span><span class="fu">paste0</span>(predOf,<span class="st">&quot;_&quot;</span>,Model),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pred=</span><span class="fu">factor</span>(Pred,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;MeanBV_A&quot;</span>,<span class="st">&quot;MeanBV_DirDomBV&quot;</span>,<span class="st">&quot;MeanTGV_AD&quot;</span>,<span class="st">&quot;MeanTGV_DirDomAD&quot;</span>)),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait=</span><span class="fu">factor</span>(Trait,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;stdSI&quot;</span>,<span class="st">&quot;biofortSI&quot;</span>,<span class="st">&quot;DM&quot;</span>,<span class="st">&quot;logFYLD&quot;</span>,<span class="st">&quot;MCMDS&quot;</span>,<span class="st">&quot;TCHART&quot;</span>)),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">predOf=</span><span class="fu">factor</span>(predOf,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;MeanBV&quot;</span>,<span class="st">&quot;MeanTGV&quot;</span>)),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Model=</span><span class="fu">factor</span>(Model,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;AD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Trait,<span class="at">y=</span>Accuracy,<span class="at">fill=</span>Pred,<span class="at">linetype=</span>predOf)) <span class="sc">+</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">&#39;darkred&#39;</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">angle=</span><span class="dv">90</span>),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>ValidationData)</span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-14-1">
Past versions of unnamed-chunk-14-1.png
</button>
</p>
<div id="fig-unnamed-chunk-14-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-14-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>From hereon, for means, only considering GBLUP validation data.</p>
</div>
<div id="compare-models" class="section level2">
<h2>Compare models</h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>accMeans <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,predOf) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">mean</span>(Accuracy)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric,<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(predOf,meanAcc) <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>MeanTGV<span class="sc">-</span>MeanBV)</span></code></pre></div>
<pre><code># A tibble: 2 x 4
# Groups:   Model [2]
  Model     MeanBV MeanTGV diffAcc
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 ClassicAD  0.538   0.495  -0.043
2 DirDom     0.541   0.543   0.002</code></pre>
<p>On average, across traits, the accuracy of predicting family-mean TGV were lower by -0.043 (0.002) for the ClassicAD (and DirDom) models.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>accMeans <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,predOf,Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">mean</span>(Accuracy)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric,<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(predOf,meanAcc) <span class="sc">%&gt;%</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>MeanTGV<span class="sc">-</span>MeanBV)</span></code></pre></div>
<pre><code># A tibble: 12 x 5
# Groups:   Model [2]
   Model     Trait     MeanBV MeanTGV diffAcc
   &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 ClassicAD biofortSI  0.609   0.531 -0.0780
 2 ClassicAD DM         0.697   0.663 -0.0340
 3 ClassicAD logFYLD    0.227   0.241  0.0140
 4 ClassicAD MCMDS      0.389   0.316 -0.073 
 5 ClassicAD stdSI      0.503   0.449 -0.0540
 6 ClassicAD TCHART     0.803   0.773 -0.03  
 7 DirDom    biofortSI  0.612   0.589 -0.023 
 8 DirDom    DM         0.698   0.679 -0.0190
 9 DirDom    logFYLD    0.222   0.349  0.127 
10 DirDom    MCMDS      0.393   0.355 -0.038 
11 DirDom    stdSI      0.51    0.491 -0.019 
12 DirDom    TCHART     0.81    0.792 -0.018 </code></pre>
<p>But on a per-trait basis, for yield MeanTGV&gt;MeanBV by 0.01 in the ClassicAD model, and was even higher (by 0.13) for the DirDom model.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>accMeans <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,predOf) <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">mean</span>(Accuracy)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric,<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Model,meanAcc) <span class="sc">%&gt;%</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>DirDom<span class="sc">-</span>ClassicAD)</span></code></pre></div>
<pre><code># A tibble: 2 x 4
  predOf  ClassicAD DirDom diffAcc
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 MeanBV      0.538  0.541   0.003
2 MeanTGV     0.495  0.543   0.048</code></pre>
<p>For both BV (0.003) and TGV (0.05), the DirDom model was on average more accurate.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>accMeans <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,predOf,Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">mean</span>(Accuracy)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric,<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Model,meanAcc) <span class="sc">%&gt;%</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>DirDom<span class="sc">-</span>ClassicAD) <span class="sc">%&gt;%</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(predOf,Trait,diffAcc) <span class="sc">%&gt;%</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(predOf,diffAcc)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  Trait     MeanBV MeanTGV
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
1 biofortSI  0.003  0.0580
2 DM         0.001  0.016 
3 logFYLD   -0.005  0.108 
4 MCMDS      0.004  0.0390
5 stdSI      0.007  0.0420
6 TCHART     0.007  0.019 </code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot(.,aes(x=MeanBV,y=MeanTGV,label=Trait)) + geom_label() + geom_point() + theme_bw() +</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(title=&quot;Compare diff Acc (DirDom-ClassicAD)&quot;) + geom_abline(slope=1)</span></span></code></pre></div>
<p>The accuracy for yield was higher for TGV than BV by 0.11had the highest increase (0.231 for BVs and 0.181 for TGVs) when using the DirDom vs. the ClassicAD model. DM and the StdSI were both more poorly predicted.</p>
</div>
</div>
<div id="predictions-of-variances-and-covariances" class="section level1">
<h1>Predictions of variances and covariances</h1>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Table S7: Predicted cross variances</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>predVars<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTable07.csv&quot;</span>),<span class="at">stringsAsFactors =</span> F)</span></code></pre></div>
<div id="pmv-vs.-vpm" class="section level2">
<h2>PMV vs. VPM</h2>
<p>First thing is to compare the PMV and VPM results. Ideally, they will be the same in accuracy and provide similar rankings. VPM is much faster and we would prefer to use it, e.g. for the predictions of untested crosses.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>predVars <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,VarComp) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corPMV_VPM=</span><span class="fu">cor</span>(VPM,PMV),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">pctIncreasePMV_over_VPM=</span><span class="fu">mean</span>((PMV<span class="sc">-</span>VPM)<span class="sc">/</span>VPM))</span></code></pre></div>
<pre><code># A tibble: 6 x 4
# Groups:   Model [4]
  Model    VarComp corPMV_VPM pctIncreasePMV_over_VPM
  &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt;                   &lt;dbl&gt;
1 A        VarA         0.987                    9.29
2 AD       VarA         0.986                   16.0 
3 AD       VarD         0.974                   12.5 
4 DirDomAD VarA         0.983                   10.4 
5 DirDomAD VarD         0.970                   16.9 
6 DirDomBV VarA         0.986                   11.7 </code></pre>
<p>Across all predictions and models, the correlation between the PMV and VPM was very high.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>predVars <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,VarComp) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corPMV_VPM=</span><span class="fu">cor</span>(VPM,PMV),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">pctIncreasePMV_over_VPM=</span><span class="fu">mean</span>((PMV<span class="sc">-</span>VPM)<span class="sc">/</span>VPM)) <span class="sc">%$%</span> <span class="fu">mean</span>(corPMV_VPM)</span></code></pre></div>
<pre><code>[1] 0.9809162</code></pre>
<p>However, there is a difference in scale between predictions by VPM and PMV as seen in the figure below.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>predVars <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VarCovar=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pred=</span><span class="fu">paste0</span>(Model,<span class="st">&quot;_&quot;</span>,VarComp),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">diffPredVar=</span>PMV<span class="sc">-</span>VPM) <span class="sc">%&gt;%</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Pred,<span class="at">y=</span>diffPredVar,<span class="at">fill=</span>Pred,<span class="at">linetype=</span>VarComp)) <span class="sc">+</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>VarCovar,<span class="at">scales=</span><span class="st">&#39;free&#39;</span>,<span class="at">nrow=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>)) <span class="sc">+</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;The difference between PMV and VPM for variance and covariance predictions&quot;</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;diffPredVar = PMV minus VPM &quot;</span>)</span></code></pre></div>
<p><img src="figure/Results.Rmd/figureS06-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-figureS06-1">
Past versions of figureS06-1.png
</button>
</p>
<div id="fig-figureS06-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/figureS06-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>PMV gave consistently higher variance predictions and <em>larger</em> covariance (<span class="math inline">\(|\sigma|\)</span>) (either more negative i.e. DM-TCHART or more positive i.e. MCMDS_TCHART).</p>
<p>What about prediction accuracy according to PMV vs. VPM?</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Table S11: Accuracies predicting the variances</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>accVars<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTables.xlsx&quot;</span>),<span class="at">sheet =</span> <span class="st">&quot;TableS11&quot;</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>AccuracyCor) <span class="sc">%&gt;%</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(VarMethod,AccuracyWtCor) <span class="sc">%&gt;%</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>PMV<span class="sc">-</span>VPM) <span class="sc">%$%</span> <span class="fu">summary</span>(diffAcc)</span></code></pre></div>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.60769 -0.14047 -0.05226 -0.07392  0.01550  0.62149 </code></pre>
<p>PMV-based estimates of prediction accuracy were nearly uniformly lower (mean decrease in acc. -0.07).</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>AccuracyCor) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(VarMethod,AccuracyWtCor) <span class="sc">%&gt;%</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VarCovar=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pred=</span><span class="fu">paste0</span>(Model,<span class="st">&quot;_&quot;</span>,predOf),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">diffAcc=</span>PMV<span class="sc">-</span>VPM) <span class="sc">%&gt;%</span> </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Pred,<span class="at">y=</span>diffAcc,<span class="at">fill=</span>Pred,<span class="at">linetype=</span>predOf)) <span class="sc">+</span> </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>VarCovar,<span class="at">scales=</span><span class="st">&#39;free&#39;</span>,<span class="at">nrow=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>)) <span class="sc">+</span> </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;The difference between PMV and VPM in terms of prediction accuracy&quot;</span>,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;diffPredAcc = predAccPMV minus predAccVPM &quot;</span>)</span></code></pre></div>
<p><img src="figure/Results.Rmd/figureS07-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-figureS07-1">
Past versions of figureS07-1.png
</button>
</p>
<div id="fig-figureS07-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/figureS07-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We will proceed with PMV results, except for the <a href="predictUntestedCrosses.html">exploratory analyses</a>, where we will save time/computation and use the VPM.</p>
</div>
<div id="compare-validation-data-types-1" class="section level2">
<h2>Compare validation data types</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>AccuracyCor) <span class="sc">%&gt;%</span> <span class="co">#count(ValidationData,Model,VarComp)</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(ValidationData,AccuracyWtCor) <span class="sc">%&gt;%</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Component=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>iidBLUPs,<span class="at">y=</span>GBLUPs,<span class="at">shape=</span>predOf,<span class="at">color=</span>Component)) <span class="sc">+</span> </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">&#39;darkred&#39;</span>) <span class="sc">+</span> </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>predOf<span class="sc">+</span>Model,<span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span> </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>)</span></code></pre></div>
<p><img src="figure/Results.Rmd/figureS08-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-figureS08-1">
Past versions of figureS08-1.png
</button>
</p>
<div id="fig-figureS08-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/figureS08-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>AccuracyCor) <span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(ValidationData,AccuracyWtCor) <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>GBLUPs<span class="sc">-</span>iidBLUPs) <span class="sc">%$%</span> <span class="fu">summary</span>(diffAcc)</span></code></pre></div>
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.400391  0.002691  0.073790  0.067121  0.136685  0.437231 </code></pre>
<p>Similar to the means, GBLUPs as validation data for variances was higher on average (mean 0.073).</p>
<p>Below I make several plots of the data to explore the consequences of using GBLUPs vs. iidBLUPs as validation data. The first one shows (for simplicity just for the variances on the SI’s) that there <em>is</em> re-ranking of accuracies b/t validation data-types. The boxplots that follow try to determine if similar conclusions would be reached from either validation data.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>forplot<span class="ot">&lt;-</span>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Trait1<span class="sc">==</span>Trait2,<span class="fu">grepl</span>(<span class="st">&quot;SI&quot;</span>,Trait1)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pred=</span><span class="fu">paste0</span>(predOf,<span class="st">&quot;_&quot;</span>,Model), </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pred=</span><span class="fu">factor</span>(Pred,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;VarBV_A&quot;</span>,<span class="st">&quot;VarBV_DirDomBV&quot;</span>,<span class="st">&quot;VarTGV_AD&quot;</span>,<span class="st">&quot;VarTGV_DirDomAD&quot;</span>)),</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait1=</span><span class="fu">factor</span>(Trait1,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;stdSI&quot;</span>,<span class="st">&quot;biofortSI&quot;</span>)),<span class="co">#,&quot;DM&quot;,&quot;logFYLD&quot;,&quot;MCMDS&quot;,&quot;TCHART&quot;)),</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait2=</span><span class="fu">factor</span>(Trait2,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;stdSI&quot;</span>,<span class="st">&quot;biofortSI&quot;</span>)),<span class="co">#,&quot;DM&quot;,&quot;logFYLD&quot;,&quot;MCMDS&quot;,&quot;TCHART&quot;)),</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Component=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">predOf=</span><span class="fu">factor</span>(predOf,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;VarBV&quot;</span>,<span class="st">&quot;VarTGV&quot;</span>)),</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Model=</span><span class="fu">factor</span>(Model,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;AD&quot;</span>,<span class="st">&quot;DirDomBV&quot;</span>,<span class="st">&quot;DirDomAD&quot;</span>)),</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">RepFold=</span><span class="fu">paste0</span>(Repeat,<span class="st">&quot;_&quot;</span>,Fold,<span class="st">&quot;_&quot;</span>,Component))</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>forplot <span class="sc">%&gt;%</span> </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>ValidationData,<span class="at">y=</span>AccuracyWtCor)) <span class="sc">+</span> </span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">data=</span>forplot,<span class="fu">aes</span>(<span class="at">fill=</span>ValidationData), <span class="at">alpha=</span><span class="fl">0.75</span>) <span class="sc">+</span> </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data=</span>forplot,<span class="fu">aes</span>(<span class="at">fill=</span>ValidationData), <span class="at">alpha=</span><span class="fl">0.85</span>, <span class="at">color=</span><span class="st">&#39;gray&#39;</span>,<span class="at">width=</span><span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>forplot,<span class="fu">aes</span>(<span class="at">group=</span>RepFold),<span class="at">color=</span><span class="st">&#39;darkred&#39;</span>,<span class="at">size=</span><span class="fl">0.6</span>,<span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>forplot,<span class="fu">aes</span>(<span class="at">color=</span>ValidationData, <span class="at">group=</span>RepFold),<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>) <span class="sc">+</span> </span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">angle=</span><span class="dv">90</span>),</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Component<span class="sc">~</span>Pred, <span class="at">scales=</span><span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span> </span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Plot of variance-prediction accuracy: Re-ranking according choice of validation?&quot;</span>)</span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-24-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-24-1">
Past versions of unnamed-chunk-24-1.png
</button>
</p>
<div id="fig-unnamed-chunk-24-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-24-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>forplot<span class="ot">&lt;-</span>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pred=</span><span class="fu">paste0</span>(predOf,<span class="st">&quot;_&quot;</span>,Model), </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pred=</span><span class="fu">factor</span>(Pred,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;VarBV_A&quot;</span>,<span class="st">&quot;VarTGV_AD&quot;</span>,<span class="st">&quot;VarBV_DirDomBV&quot;</span>,<span class="st">&quot;VarTGV_DirDomAD&quot;</span>)),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait1=</span><span class="fu">factor</span>(Trait1,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;stdSI&quot;</span>,<span class="st">&quot;biofortSI&quot;</span>,<span class="st">&quot;DM&quot;</span>,<span class="st">&quot;logFYLD&quot;</span>,<span class="st">&quot;MCMDS&quot;</span>,<span class="st">&quot;TCHART&quot;</span>)),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait2=</span><span class="fu">factor</span>(Trait2,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;stdSI&quot;</span>,<span class="st">&quot;biofortSI&quot;</span>,<span class="st">&quot;DM&quot;</span>,<span class="st">&quot;logFYLD&quot;</span>,<span class="st">&quot;MCMDS&quot;</span>,<span class="st">&quot;TCHART&quot;</span>)),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Component=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">predOf=</span><span class="fu">factor</span>(predOf,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;VarBV&quot;</span>,<span class="st">&quot;VarTGV&quot;</span>)),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Model=</span><span class="fu">factor</span>(Model,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;AD&quot;</span>,<span class="st">&quot;DirDomBV&quot;</span>,<span class="st">&quot;DirDomAD&quot;</span>)),</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">RepFold=</span><span class="fu">paste0</span>(Repeat,<span class="st">&quot;_&quot;</span>,Fold,<span class="st">&quot;_&quot;</span>,Component))</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>forplot <span class="sc">%&gt;%</span> </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Trait1<span class="sc">==</span>Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Component,<span class="at">y=</span>AccuracyWtCor,<span class="at">fill=</span>Pred,<span class="at">linetype=</span>predOf)) <span class="sc">+</span> </span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">&#39;darkred&#39;</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">angle=</span><span class="dv">90</span>),</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ValidationData,<span class="at">scales=</span><span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Plot of &quot;</span>, <span class="fu">underline</span>(variance), <span class="st">&quot;-prediction accuracy&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;GBLUPs vs. iidBLUPs as validation-data&quot;</span>)</span></code></pre></div>
<p><img src="figure/Results.Rmd/figureS10a-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-figureS10a-1">
Past versions of figureS10a-1.png
</button>
</p>
<div id="fig-figureS10a-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/figureS10a-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>forplot <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Trait1<span class="sc">!=</span>Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Component,<span class="at">y=</span>AccuracyWtCor,<span class="at">fill=</span>Pred,<span class="at">linetype=</span>predOf)) <span class="sc">+</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">&#39;darkred&#39;</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">angle=</span><span class="dv">90</span>),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ValidationData,<span class="at">scales=</span><span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Plot of &quot;</span>, <span class="fu">underline</span>(co), <span class="st">&quot;variance-prediction accuracy&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;GBLUPs vs. iidBLUPs as validation-data&quot;</span>)</span></code></pre></div>
<p><img src="figure/Results.Rmd/figureS10b-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-figureS10b-1">
Past versions of figureS10b-1.png
</button>
</p>
<div id="fig-figureS10b-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/figureS10b-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The two sets of boxplots (variances and covariances) above suggest that we would reach similar but less strong conclusions above the difference between prediction models and variance components. Moreover, we would reach similar conclusions about which trait variances and trait-trait covariances are best or worst predicted. We consider for our primary conclusions, the prediction accuracy with GBLUP-derived validation data.</p>
</div>
<div id="what-difference-does-the-weighted-correlation-make" class="section level2">
<h2>What difference does the weighted correlation make?</h2>
<p>For variances (but not means), we chose to weight prediction-observation pairs according to the number of family members (GBLUPs-as-validation) or the number of observed non-missing iid-BLUPs per family per trait (iidBLUPs-as-validation) when computing prediction accuracies. The weighted correlations should be justified because large families (or heavily phenotyped ones) should have better-estimated variances than small ones. Below, we consider briefly the effect weighted correlations have on results.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VarMethod,ValidationData,predOf,Model) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corWT_vs_noWT=</span><span class="fu">cor</span>(AccuracyWtCor,AccuracyCor)) <span class="sc">%$%</span> <span class="fu">summary</span>(corWT_vs_noWT)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.7844  0.8261  0.8727  0.8674  0.9039  0.9396 </code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VarMethod,ValidationData,predOf,Model,Trait1,Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corWT_vs_noWT=</span><span class="fu">cor</span>(AccuracyWtCor,AccuracyCor)) <span class="sc">%$%</span> <span class="fu">summary</span>(corWT_vs_noWT)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.5549  0.7381  0.8107  0.7935  0.8627  0.9188 </code></pre>
<p>We found that the weighted-vs-unweighted accuracies are themselves similar highly correlated (mean cor. 0.87) across traits, varcomps, models and validation-data types.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>AccuracyWtCor<span class="sc">-</span>AccuracyCor) <span class="sc">%$%</span> <span class="fu">summary</span>(diffAcc)</span></code></pre></div>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.21630 -0.03242  0.01519  0.01500  0.06172  0.22821 </code></pre>
<p>Definitely not a consistent increase or decrease in accuracy according to weighting.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>AccuracyWtCor<span class="sc">-</span>AccuracyCor) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VarMethod,ValidationData,predOf,Model) <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanDiffAcc_WT_vs_noWT=</span><span class="fu">mean</span>(diffAcc))</span></code></pre></div>
<pre><code># A tibble: 16 x 5
# Groups:   VarMethod, ValidationData, predOf [8]
   VarMethod ValidationData predOf Model    meanDiffAcc_WT_vs_noWT
   &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt;                     &lt;dbl&gt;
 1 PMV       GBLUPs         VarBV  A                       0.00656
 2 PMV       GBLUPs         VarBV  DirDomBV                0.00817
 3 PMV       GBLUPs         VarTGV AD                      0.0135 
 4 PMV       GBLUPs         VarTGV DirDomAD                0.0121 
 5 PMV       iidBLUPs       VarBV  A                       0.00567
 6 PMV       iidBLUPs       VarBV  DirDomBV                0.00610
 7 PMV       iidBLUPs       VarTGV AD                      0.00880
 8 PMV       iidBLUPs       VarTGV DirDomAD                0.00716
 9 VPM       GBLUPs         VarBV  A                       0.0287 
10 VPM       GBLUPs         VarBV  DirDomBV                0.0260 
11 VPM       GBLUPs         VarTGV AD                      0.0334 
12 VPM       GBLUPs         VarTGV DirDomAD                0.0350 
13 VPM       iidBLUPs       VarBV  A                       0.0111 
14 VPM       iidBLUPs       VarBV  DirDomBV                0.00975
15 VPM       iidBLUPs       VarTGV AD                      0.0140 
16 VPM       iidBLUPs       VarTGV DirDomAD                0.0140 </code></pre>
<p>Across varcomps, models, validation-data and var. methods (PMV vs. VPM), very close to mean 0 diff. b/t WT and no WT, but generally WT&gt;noWT.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>,ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pred=</span><span class="fu">paste0</span>(predOf,<span class="st">&quot;_&quot;</span>,Model), </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pred=</span><span class="fu">factor</span>(Pred,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;VarBV_A&quot;</span>,<span class="st">&quot;VarTGV_AD&quot;</span>,<span class="st">&quot;VarBV_DirDomBV&quot;</span>,<span class="st">&quot;VarTGV_DirDomAD&quot;</span>)),</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">diffAcc=</span>AccuracyWtCor<span class="sc">-</span>AccuracyCor,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Component=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Pred,Component) <span class="sc">%&gt;%</span> </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanDiffAcc_WT_vs_noWT=</span><span class="fu">round</span>(<span class="fu">mean</span>(diffAcc),<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Pred,meanDiffAcc_WT_vs_noWT)</span></code></pre></div>
<pre><code># A tibble: 12 x 5
   Component           VarBV_A VarTGV_AD VarBV_DirDomBV VarTGV_DirDomAD
   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;
 1 biofortSI_biofortSI  -0.005     0.023          0.004           0.014
 2 DM_DM                 0.014    -0.016          0.018          -0.004
 3 DM_logFYLD            0.014     0.019          0.013           0.015
 4 DM_MCMDS             -0.031    -0.024         -0.043          -0.029
 5 DM_TCHART             0.065     0.049          0.062           0.057
 6 logFYLD_logFYLD       0.002     0.056          0.006           0.052
 7 logFYLD_MCMDS         0.065     0.101          0.066           0.078
 8 logFYLD_TCHART       -0.007    -0.034          0.006          -0.012
 9 MCMDS_MCMDS           0.007     0.033          0.01            0.02 
10 MCMDS_TCHART         -0.028    -0.041         -0.027          -0.032
11 stdSI_stdSI          -0.011     0.02          -0.008           0    
12 TCHART_TCHART        -0.009    -0.023         -0.007          -0.015</code></pre>
<p>Considering the boxplots below, conclusions appear to be at least qualitatively similar whether or not weighted correlations are considered as measures of accuracy.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>forplot<span class="ot">&lt;-</span>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>,ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">contains</span>(<span class="st">&quot;Cor&quot;</span>),<span class="at">names_to =</span> <span class="st">&quot;WT_or_NoWT&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Accuracy&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">Pred=</span><span class="fu">paste0</span>(predOf,<span class="st">&quot;_&quot;</span>,Model), </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pred=</span><span class="fu">factor</span>(Pred,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;VarBV_A&quot;</span>,<span class="st">&quot;VarTGV_AD&quot;</span>,<span class="st">&quot;VarBV_DirDomBV&quot;</span>,<span class="st">&quot;VarTGV_DirDomAD&quot;</span>)),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait1=</span><span class="fu">factor</span>(Trait1,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;stdSI&quot;</span>,<span class="st">&quot;biofortSI&quot;</span>,<span class="st">&quot;DM&quot;</span>,<span class="st">&quot;logFYLD&quot;</span>,<span class="st">&quot;MCMDS&quot;</span>,<span class="st">&quot;TCHART&quot;</span>)),</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait2=</span><span class="fu">factor</span>(Trait2,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;stdSI&quot;</span>,<span class="st">&quot;biofortSI&quot;</span>,<span class="st">&quot;DM&quot;</span>,<span class="st">&quot;logFYLD&quot;</span>,<span class="st">&quot;MCMDS&quot;</span>,<span class="st">&quot;TCHART&quot;</span>)),</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Component=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">predOf=</span><span class="fu">factor</span>(predOf,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;VarBV&quot;</span>,<span class="st">&quot;VarTGV&quot;</span>)),</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Model=</span><span class="fu">factor</span>(Model,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;AD&quot;</span>,<span class="st">&quot;DirDomBV&quot;</span>,<span class="st">&quot;DirDomAD&quot;</span>)),</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">RepFold=</span><span class="fu">paste0</span>(Repeat,<span class="st">&quot;_&quot;</span>,Fold,<span class="st">&quot;_&quot;</span>,Component))</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>forplot <span class="sc">%&gt;%</span> </span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Trait1<span class="sc">==</span>Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Component,<span class="at">y=</span>Accuracy,<span class="at">fill=</span>Pred,<span class="at">linetype=</span>predOf)) <span class="sc">+</span> </span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">&#39;darkred&#39;</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">angle=</span><span class="dv">90</span>),</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>WT_or_NoWT,<span class="at">scales=</span><span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Plot of &quot;</span>, <span class="fu">underline</span>(variance), <span class="st">&quot;-prediction accuracy&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;Weighted vs. Unweighted Correlation, GBLUPs as validation-data&quot;</span>)</span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-30-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-30-1">
Past versions of unnamed-chunk-30-1.png
</button>
</p>
<div id="fig-unnamed-chunk-30-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-30-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>forplot <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Trait1<span class="sc">!=</span>Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Component,<span class="at">y=</span>Accuracy,<span class="at">fill=</span>Pred,<span class="at">linetype=</span>predOf)) <span class="sc">+</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">&#39;darkred&#39;</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">angle=</span><span class="dv">90</span>),</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>WT_or_NoWT,<span class="at">scales=</span><span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Plot of &quot;</span>, <span class="fu">underline</span>(co), <span class="st">&quot;variance-prediction accuracy&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;Weighted vs. Unweighted Correlation, GBLUPs as validation-data&quot;</span>)</span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-31-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-31-1">
Past versions of unnamed-chunk-31-1.png
</button>
</p>
<div id="fig-unnamed-chunk-31-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-31-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="compare-models-1" class="section level2">
<h2>Compare models</h2>
<p>We consider the accuracy of predicting variances (and subsequently also usefulness criteria) using the “PMV” variance method, GBLUPs as validation-data and family-size-weighted correlations.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr);</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Table S11: Accuracies predicting the variances</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>accVars<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTables.xlsx&quot;</span>),<span class="at">sheet =</span> <span class="st">&quot;TableS11&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>,VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>),</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Component=</span><span class="fu">ifelse</span>(Trait1<span class="sc">==</span>Trait2,<span class="st">&quot;Variance&quot;</span>,<span class="st">&quot;Covariance&quot;</span>),</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">TraitType=</span><span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;SI&quot;</span>,Trait1),<span class="st">&quot;SI&quot;</span>,<span class="st">&quot;ComponentTrait&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Component) <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">round</span>(<span class="fu">mean</span>(AccuracyWtCor),<span class="dv">3</span>),</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sdAcc=</span><span class="fu">round</span>(<span class="fu">sd</span>(AccuracyWtCor),<span class="dv">3</span>))</span></code></pre></div>
<pre><code># A tibble: 2 x 3
  Component  meanAcc sdAcc
* &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
1 Covariance   0.085 0.135
2 Variance     0.143 0.119</code></pre>
<p>Most variance prediction accuracy estimates were positive, with a mean weighted correlation of 0.14. Mean accuracy for covariance prediction was less (0.09).</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>,VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>),</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Component=</span><span class="fu">ifelse</span>(Trait1<span class="sc">==</span>Trait2,<span class="st">&quot;Variance&quot;</span>,<span class="st">&quot;Covariance&quot;</span>),</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">TraitType=</span><span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;SI&quot;</span>,Trait1),<span class="st">&quot;SI&quot;</span>,<span class="st">&quot;ComponentTrait&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Component,TraitType,Trait1,Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">round</span>(<span class="fu">mean</span>(AccuracyWtCor),<span class="dv">3</span>)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(meanAcc))</span></code></pre></div>
<pre><code># A tibble: 12 x 5
# Groups:   Component, TraitType, Trait1 [9]
   Component  TraitType      Trait1    Trait2    meanAcc
   &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;
 1 Covariance ComponentTrait DM        TCHART      0.236
 2 Variance   ComponentTrait MCMDS     MCMDS       0.235
 3 Variance   SI             stdSI     stdSI       0.177
 4 Covariance ComponentTrait logFYLD   MCMDS       0.168
 5 Variance   ComponentTrait logFYLD   logFYLD     0.167
 6 Variance   ComponentTrait TCHART    TCHART      0.131
 7 Variance   SI             biofortSI biofortSI   0.079
 8 Variance   ComponentTrait DM        DM          0.066
 9 Covariance ComponentTrait DM        MCMDS       0.059
10 Covariance ComponentTrait MCMDS     TCHART      0.047
11 Covariance ComponentTrait logFYLD   TCHART      0.002
12 Covariance ComponentTrait DM        logFYLD    -0.001</code></pre>
<p>In contrast to results for predicting family means, the most accurately predicted trait-variances were MCMDS (mean acc. 0.24) and logFYLD (mean acc. 0.17) while Var(DM), for example, had among the lowest accuracies at 0.07). Interestingly, the DM-TCHART covariance was the most well predicted component (mean acc. 0.24). Accuracy for the selection index variances were intermediate (mean stdSI = 0.18, mean biofortSI = 0.08) compared to the component traits. Like the accuracy for means on the SI’s, accuracy for variance corresponding to the accuracy of the component traits. In contrast to predicting cross means on SI’s, for variances, the stdSI &gt; biofortSI. This makes sense as the stdSI emphasized logFYLD and MCMDS, which are better predicted than DM, TCHART and related covariances.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>,VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,predOf) <span class="sc">%&gt;%</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">mean</span>(AccuracyWtCor)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric,<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(predOf,meanAcc) <span class="sc">%&gt;%</span> </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>VarTGV<span class="sc">-</span>VarBV)</span></code></pre></div>
<pre><code># A tibble: 2 x 4
# Groups:   Model [2]
  Model     VarBV VarTGV diffAcc
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 ClassicAD 0.112  0.124  0.0120
2 DirDom    0.11   0.108 -0.002 </code></pre>
<p>There were, overall, only small differences in accuracy between prediction models (ClassicAD and DirDom) and var. components (VarBV, VarTGV). On average, across trait variances and covariances, the accuracy of predicting family-(co)variance in TGV were higher (than predicting VarBV) by 0.01 for the ClassicAD but lower by -0.002 for the DirDom model.</p>
<p>VarTGV: ClassicAD was best for most components.</p>
<p>VarBV: DirDom was best for most components.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interesting differences between accuracy VarBV vs. VarTGV? </span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>,VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>),</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Component=</span><span class="fu">ifelse</span>(Trait1<span class="sc">==</span>Trait2,<span class="st">&quot;Variance&quot;</span>,<span class="st">&quot;Covariance&quot;</span>),</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,predOf,Component,Trait,Trait1,Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">round</span>(<span class="fu">mean</span>(AccuracyWtCor),<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(predOf,meanAcc) <span class="sc">%&gt;%</span> </span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>VarTGV<span class="sc">-</span>VarBV) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Model,<span class="fu">desc</span>(diffAcc))</span></code></pre></div>
<pre><code># A tibble: 24 x 8
# Groups:   Model, Component, Trait, Trait1 [24]
   Model     Component  Trait           Trait1   Trait2    VarBV VarTGV  diffAcc
   &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 ClassicAD Covariance DM_logFYLD      DM       logFYLD  -0.036  0.048  0.0840 
 2 ClassicAD Covariance logFYLD_MCMDS   logFYLD  MCMDS     0.166  0.213  0.0470 
 3 ClassicAD Variance   logFYLD_logFYLD logFYLD  logFYLD   0.147  0.193  0.046  
 4 ClassicAD Covariance logFYLD_TCHART  logFYLD  TCHART   -0.016  0.024  0.04   
 5 ClassicAD Variance   stdSI_stdSI     stdSI    stdSI     0.172  0.197  0.025  
 6 ClassicAD Covariance DM_MCMDS        DM       MCMDS     0.059  0.079  0.02   
 7 ClassicAD Variance   biofortSI_biof… biofort… biofort…  0.076  0.09   0.0140 
 8 ClassicAD Covariance MCMDS_TCHART    MCMDS    TCHART    0.044  0.042 -0.00200
 9 ClassicAD Variance   MCMDS_MCMDS     MCMDS    MCMDS     0.243  0.239 -0.004  
10 ClassicAD Variance   TCHART_TCHART   TCHART   TCHART    0.147  0.113 -0.0340 
# … with 14 more rows</code></pre>
<p>Interesting differences between accuracy VarBV vs. VarTGV?</p>
<p>The largest increases (diffAcc = accVarTGV - accVarBV) were logFYLD-MCMDS (0.065) and logFYLD-TCHART (0.053) followed by the stdSI variance (0.04), all for the ClassicAD model. VarTGV was better predicted than VarBV for yield in the ClassicAD model (0.03), but decreased sharply (-0.08) for the DirDom model.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interesting differences between accuracy DirDom vs. ClassicAD? </span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>,VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Component=</span><span class="fu">ifelse</span>(Trait1<span class="sc">==</span>Trait2,<span class="st">&quot;Variance&quot;</span>,<span class="st">&quot;Covariance&quot;</span>),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,predOf,Component,Trait,Trait1,Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">round</span>(<span class="fu">mean</span>(AccuracyWtCor),<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Model,meanAcc) <span class="sc">%&gt;%</span> </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffAcc=</span>DirDom<span class="sc">-</span>ClassicAD) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(predOf,<span class="fu">desc</span>(diffAcc))</span></code></pre></div>
<pre><code># A tibble: 24 x 8
# Groups:   predOf, Component, Trait, Trait1 [24]
   predOf Component  Trait           Trait1   Trait2   ClassicAD DirDom  diffAcc
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 VarBV  Covariance DM_logFYLD      DM       logFYLD     -0.036 -0.008  0.0280 
 2 VarBV  Variance   logFYLD_logFYLD logFYLD  logFYLD      0.147  0.171  0.024  
 3 VarBV  Covariance DM_TCHART       DM       TCHART       0.261  0.266  0.005  
 4 VarBV  Variance   DM_DM           DM       DM           0.082  0.087  0.00500
 5 VarBV  Covariance MCMDS_TCHART    MCMDS    TCHART       0.044  0.046  0.002  
 6 VarBV  Variance   biofortSI_biof… biofort… biofort…     0.076  0.078  0.002  
 7 VarBV  Variance   TCHART_TCHART   TCHART   TCHART       0.147  0.146 -0.001  
 8 VarBV  Covariance logFYLD_TCHART  logFYLD  TCHART      -0.016 -0.02  -0.004  
 9 VarBV  Variance   stdSI_stdSI     stdSI    stdSI        0.172  0.163 -0.00900
10 VarBV  Variance   MCMDS_MCMDS     MCMDS    MCMDS        0.243  0.224 -0.0190 
# … with 14 more rows</code></pre>
<p>Focusing next on differences between the DirDom and ClassicAD models (diffAcc = DirDom - ClassicAD).</p>
<p>logFYLD and logFYLD-TCHART variances and covariances for BVs were up by 0.1 for DirDom. In contrast, both of these components for TGV were down (-0.01 logFYLD, -0.05 logFYLD-TCHART).</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>,VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>, <span class="fu">grepl</span>(<span class="st">&quot;SI&quot;</span>,Trait1)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>),</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Component=</span><span class="fu">ifelse</span>(Trait1<span class="sc">==</span>Trait2,<span class="st">&quot;Variance&quot;</span>,<span class="st">&quot;Covariance&quot;</span>),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait,Trait1,Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">round</span>(<span class="fu">mean</span>(AccuracyWtCor),<span class="dv">3</span>)) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() </span></code></pre></div>
<pre><code># A tibble: 2 x 4
  Trait               Trait1    Trait2    meanAcc
  &lt;chr&gt;               &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;
1 biofortSI_biofortSI biofortSI biofortSI   0.079
2 stdSI_stdSI         stdSI     stdSI       0.177</code></pre>
<p>Regarding the selection index variance accuracies:</p>
<p>On average, the accuracy for the StdSI was twice that of the biofortSI (0.18 vs. 0.08).</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>,VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>, <span class="fu">grepl</span>(<span class="st">&quot;SI&quot;</span>,Trait1)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>),</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Component=</span><span class="fu">ifelse</span>(Trait1<span class="sc">==</span>Trait2,<span class="st">&quot;Variance&quot;</span>,<span class="st">&quot;Covariance&quot;</span>),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,predOf,Component,Trait,Trait1,Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">round</span>(<span class="fu">mean</span>(AccuracyWtCor),<span class="dv">3</span>)) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Trait,<span class="sc">-</span>Trait2,<span class="sc">-</span>Component) <span class="sc">%&gt;%</span> <span class="fu">spread</span>(predOf,meanAcc)</span></code></pre></div>
<pre><code># A tibble: 4 x 4
  Model     Trait1    VarBV VarTGV
  &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
1 ClassicAD biofortSI 0.076  0.09 
2 ClassicAD stdSI     0.172  0.197
3 DirDom    biofortSI 0.078  0.07 
4 DirDom    stdSI     0.163  0.176</code></pre>
<p>For both models and both indices, VarTGV was better predicted than VarBV.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>accVars <span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ValidationData<span class="sc">==</span><span class="st">&quot;GBLUPs&quot;</span>,VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>, <span class="fu">grepl</span>(<span class="st">&quot;SI&quot;</span>,Trait1)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;DirDom&quot;</span>,Model),<span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;DirDom&quot;</span>),</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Component=</span><span class="fu">ifelse</span>(Trait1<span class="sc">==</span>Trait2,<span class="st">&quot;Variance&quot;</span>,<span class="st">&quot;Covariance&quot;</span>),</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trait=</span><span class="fu">paste0</span>(Trait1,<span class="st">&quot;_&quot;</span>,Trait2)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,predOf,Component,Trait,Trait1,Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">round</span>(<span class="fu">mean</span>(AccuracyWtCor),<span class="dv">3</span>)) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Trait,<span class="sc">-</span>Trait2,<span class="sc">-</span>Component) <span class="sc">%&gt;%</span> <span class="fu">spread</span>(Model,meanAcc)</span></code></pre></div>
<pre><code># A tibble: 4 x 4
  predOf Trait1    ClassicAD DirDom
  &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;
1 VarBV  biofortSI     0.076  0.078
2 VarBV  stdSI         0.172  0.163
3 VarTGV biofortSI     0.09   0.07 
4 VarTGV stdSI         0.197  0.176</code></pre>
<p>However, the DirDom model (compared to the ClassicAD model) increased accuracy slightly for both VarBV and VarTGV on the biofortSI, but decreased it on the StdSI.</p>
</div>
</div>
<div id="prediction-of-the-uc" class="section level1">
<h1>Prediction of the UC</h1>
<p>The usefulness criteria i.e. <span class="math inline">\(UC_{parent}\)</span> and <span class="math inline">\(UC_{clone}\)</span> are predicted by:</p>
<p><span class="math display">\[UC_{parent}=UC_{RS}=\mu_{BV} + (i_{RS} \times \sigma_{BV})\]</span></p>
<p><span class="math display">\[UC_{clone}=UC_{VDP}=\mu_{TGV} + (i_{VDP} \times \sigma_{TGV})\]</span></p>
<p>The observed (or realized) <strong>UC</strong> are the mean <strong>GEBV</strong> of family members who were themselves later used as parents.</p>
<p>In order to combined predicted means and variances into a <strong>UC</strong>, we first calculated the realized intensity of within-family selection (<span class="math inline">\(i_{RS}\)</span> and <span class="math inline">\(i_{VDP}\)</span>). For <span class="math inline">\(UC_{parent}\)</span> we computed the <span class="math inline">\(i_{RS}\)</span> based on the proportion of progeny from each family, that themselves later appeared in the pedigree as parents. For <span class="math inline">\(UC_{clone}\)</span> we compute computed <span class="math inline">\(i_{VDP}\)</span> based on the proportion of family-members that had at least one plot at each <strong>VDP</strong> stage (CET, PYT, AYT, UYT).</p>
<p>Below, we plot the proportion of each family selected (A) and the selection intensity (B) for each stage.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr);</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Table S13: Realized within-cross selection metrics</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>crossmetrics<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTables.xlsx&quot;</span>),<span class="at">sheet =</span> <span class="st">&quot;TableS13&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>propPast<span class="ot">&lt;-</span>crossmetrics <span class="sc">%&gt;%</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cycle=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;TMS13|TMS14|TMS15&quot;</span>,sireID) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;TMS13|TMS14|TMS15&quot;</span>,damID),<span class="st">&quot;C0&quot;</span>,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS13&quot;</span>,sireID) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;TMS13&quot;</span>,damID),<span class="st">&quot;C1&quot;</span>,</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS14&quot;</span>,sireID) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;TMS14&quot;</span>,damID),<span class="st">&quot;C2&quot;</span>,</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS15&quot;</span>,sireID) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;TMS15&quot;</span>,damID),<span class="st">&quot;C3&quot;</span>,<span class="st">&quot;mixed&quot;</span>))))) <span class="sc">%&gt;%</span> </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Cycle,<span class="fu">starts_with</span>(<span class="st">&quot;prop&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">&quot;prop&quot;</span>),<span class="at">values_to =</span> <span class="st">&quot;PropPast&quot;</span>,<span class="at">names_to =</span> <span class="st">&quot;StagePast&quot;</span>,<span class="at">names_prefix =</span> <span class="st">&quot;propPast|prop&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DescendentsOfCycle=</span>Cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">StagePast=</span><span class="fu">gsub</span>(<span class="st">&quot;UsedAs&quot;</span>,<span class="st">&quot;&quot;</span>,StagePast),</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">StagePast=</span><span class="fu">factor</span>(StagePast,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Parent&quot;</span>,<span class="st">&quot;Phenotyped&quot;</span>,<span class="st">&quot;CET&quot;</span>,<span class="st">&quot;PYT&quot;</span>,<span class="st">&quot;AYT&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>StagePast,<span class="at">y=</span>PropPast,<span class="at">fill=</span>DescendentsOfCycle)) <span class="sc">+</span> </span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="st">&#39;dodge2&#39;</span>,<span class="at">color=</span><span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>()  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Proportion of Family Selected&quot;</span>) <span class="sc">+</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>realIntensity<span class="ot">&lt;-</span>crossmetrics <span class="sc">%&gt;%</span> </span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cycle=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;TMS13|TMS14|TMS15&quot;</span>,sireID) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;TMS13|TMS14|TMS15&quot;</span>,damID),<span class="st">&quot;C0&quot;</span>,</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS13&quot;</span>,sireID) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;TMS13&quot;</span>,damID),<span class="st">&quot;C1&quot;</span>,</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS14&quot;</span>,sireID) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;TMS14&quot;</span>,damID),<span class="st">&quot;C2&quot;</span>,</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TMS15&quot;</span>,sireID) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;TMS15&quot;</span>,damID),<span class="st">&quot;C3&quot;</span>,<span class="st">&quot;mixed&quot;</span>))))) <span class="sc">%&gt;%</span> </span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Cycle,sireID,damID,<span class="fu">contains</span>(<span class="st">&quot;realIntensity&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">&quot;realIntensity&quot;</span>),<span class="at">names_to =</span> <span class="st">&quot;Stage&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Intensity&quot;</span>,<span class="at">names_prefix =</span> <span class="st">&quot;realIntensity&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DescendentsOfCycle=</span>Cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>  distinct <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Stage=</span><span class="fu">factor</span>(Stage,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Parent&quot;</span>,<span class="st">&quot;CET&quot;</span>,<span class="st">&quot;PYT&quot;</span>,<span class="st">&quot;AYT&quot;</span>,<span class="st">&quot;UYT&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Stage,<span class="at">y=</span>Intensity,<span class="at">fill=</span>DescendentsOfCycle)) <span class="sc">+</span> </span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="st">&#39;dodge2&#39;</span>,<span class="at">color=</span><span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>()  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Stadardized Selection Intensity&quot;</span>)</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>propPast <span class="sc">+</span> realIntensity <span class="sc">+</span>  </span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>,</span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">&#39;Realized selection intensities: measuring post-cross selection&#39;</span>) <span class="sc">&amp;</span> </span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face=</span><span class="st">&#39;bold&#39;</span>),</span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">face=</span><span class="st">&#39;bold&#39;</span>),</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>, <span class="at">face=</span><span class="st">&#39;bold&#39;</span>))</span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-42-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-42-1">
Past versions of unnamed-chunk-42-1.png
</button>
</p>
<div id="fig-unnamed-chunk-42-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-42-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The table below provides a quick summary of the number of families available with realized selection observed at each stage, plus the corresponding mean selection intensity and proportion selected across families.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(crossmetrics <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(sireID,damID,<span class="fu">contains</span>(<span class="st">&quot;realIntensity&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">&quot;realIntensity&quot;</span>),<span class="at">names_to =</span> <span class="st">&quot;Stage&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Intensity&quot;</span>,<span class="at">names_prefix =</span> <span class="st">&quot;realIntensity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(Stage) <span class="sc">%&gt;%</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarize</span>(<span class="at">meanIntensity=</span><span class="fu">mean</span>(Intensity, <span class="at">na.rm =</span> T),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Nfam=</span><span class="fu">length</span>(<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)))),</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>          crossmetrics <span class="sc">%&gt;%</span> </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(sireID,damID,<span class="fu">contains</span>(<span class="st">&quot;prop&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">propParent=</span>propUsedAsParent,</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">propCET=</span>propPhenotyped,</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">propPYT=</span>propPastCET,</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">propAYT=</span>propPastPYT,</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">propUYT=</span>propPastAYT) <span class="sc">%&gt;%</span> </span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">&quot;prop&quot;</span>),<span class="at">values_to =</span> <span class="st">&quot;PropPast&quot;</span>,<span class="at">names_to =</span> <span class="st">&quot;Stage&quot;</span>,<span class="at">names_prefix =</span> <span class="st">&quot;propPast|prop&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(Stage) <span class="sc">%&gt;%</span> </span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarize</span>(<span class="at">meanPropPast=</span><span class="fu">mean</span>(PropPast, <span class="at">na.rm =</span> T))) <span class="sc">%&gt;%</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Stage=</span><span class="fu">factor</span>(Stage,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Parent&quot;</span>,<span class="st">&quot;CET&quot;</span>,<span class="st">&quot;PYT&quot;</span>,<span class="st">&quot;AYT&quot;</span>,<span class="st">&quot;UYT&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Stage) <span class="sc">%&gt;%</span> </span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Stage,Nfam,meanIntensity,meanPropPast) <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric,<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">2</span>))</span></code></pre></div>
<pre><code># A tibble: 5 x 4
  Stage   Nfam meanIntensity meanPropPast
  &lt;fct&gt;  &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
1 Parent   866          1.59         0.02
2 CET     7446          0.26         0.76
3 PYT     5164          0.9          0.3 
4 AYT     1864          1.45         0.05
5 UYT      706          1.4          0.03</code></pre>
<p>There were 48 families with a mean intensity of 1.59 (mean 2% selected) that themselves had members who were parents in the pedigree.</p>
<p>As expected, the number of available families and the proportion selected decreased (increasing selection intensity) from CET to UYT. We choose to focus on the AYT stage, which has 104 families, mean intensity 1.46 (mean 5% selected).</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr);</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Table S9: Predicted and observed UC</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>predVSobsUC<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTable09.csv&quot;</span>),<span class="at">stringsAsFactors =</span> F)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>uc_cv_summary<span class="ot">&lt;-</span>predVSobsUC <span class="sc">%&gt;%</span> </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,predOf,Stage,Trait,Repeat,Fold) <span class="sc">%&gt;%</span> </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Nfam=</span><span class="fu">n</span>(),</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanFamSize=</span><span class="fu">round</span>(<span class="fu">mean</span>(FamSize),<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Trait,<span class="sc">-</span>Model) <span class="sc">%&gt;%</span> </span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  distinct</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>uc_cv_summary <span class="sc">%&gt;%</span> </span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(predOf,Stage) <span class="sc">%&gt;%</span> </span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">minNfam=</span><span class="fu">min</span>(Nfam),</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanNfam=</span><span class="fu">mean</span>(Nfam),</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxNfam=</span><span class="fu">max</span>(Nfam),</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">minMeanFamSize=</span><span class="fu">min</span>(meanFamSize),</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanMeanFamSize=</span><span class="fu">mean</span>(meanFamSize),</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxMeanFamSize=</span><span class="fu">max</span>(meanFamSize))</span></code></pre></div>
<pre><code># A tibble: 7 x 8
# Groups:   predOf [2]
  predOf Stage minNfam meanNfam maxNfam minMeanFamSize meanMeanFamSize
  &lt;chr&gt;  &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;   &lt;int&gt;          &lt;dbl&gt;           &lt;dbl&gt;
1 BV     Cons…     143    166.      204            5.9            6.85
2 BV     Pare…       9     17.3      24            8.8           13.8 
3 TGV    AYT        25     37.3      50           10.9           12.9 
4 TGV    CET       129    149.      192            6.3            7.48
5 TGV    Cons…     143    166.      204            5.9            6.85
6 TGV    PYT        69    103.      142            7.3            8.73
7 TGV    UYT         8     14.1      20            7.3           11.8 
# … with 1 more variable: maxMeanFamSize &lt;dbl&gt;</code></pre>
<p>On a per-repeat-fold basis, sample sizes (number of families) with observed usefulness (and thus for measuring prediction accuracy) were limited. For <span class="math inline">\(UC_{parent}\)</span> there were an average of 17 families (min 9, max 24). For <span class="math inline">\(UC_{clone}\)</span> the sizes depending on the Stage, with the focal stage <span class="math inline">\(UC_{clone}^{[AYT]}\)</span> mean number of families was 37 (min 25, max 50).</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>predVSobsUC <span class="sc">%&gt;%</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>,Stage <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Parent&quot;</span>,<span class="st">&quot;AYT&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>predMean,<span class="sc">-</span>predSD,<span class="sc">-</span>realIntensity) <span class="sc">%&gt;%</span> </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">predVSobs=</span><span class="fu">c</span>(sireID,damID,predUC,obsUC,FamSize,Repeat,Fold,Model)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AccuracyWtCor=</span><span class="fu">map_dbl</span>(predVSobs,<span class="sc">~</span>psych<span class="sc">::</span><span class="fu">cor.wt</span>(.[,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>],<span class="at">w =</span> .<span class="sc">$</span>FamSize) <span class="sc">%$%</span> <span class="fu">round</span>(r[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>predVSobs,<span class="sc">-</span>VarMethod,<span class="sc">-</span>predOf) <span class="sc">%&gt;%</span> </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Stage,AccuracyWtCor)</span></code></pre></div>
<pre><code># A tibble: 2 x 3
  Trait       AYT Parent
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
1 biofortSI  0.38   0.61
2 stdSI      0.24   0.46</code></pre>
<p>Computing a single accuracy across all repeats, folds <em>and</em> models, the <span class="math inline">\(UC_{parent}\)</span> criterion is more accurately predicted (0.46 stdSI, 0.61 biofortSI) than <span class="math inline">\(UC_{clone}^{[AYT]}\)</span> (0.24 stdSI, 0.38 biofortSI).</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr);</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Table S12: Accuracies predicting the usefulness criteria</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>accUC<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTables.xlsx&quot;</span>),<span class="at">sheet =</span> <span class="st">&quot;TableS12&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>accUC <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>,Stage <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Parent&quot;</span>,<span class="st">&quot;AYT&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">round</span>(<span class="fu">mean</span>(AccuracyWtCor),<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code># A tibble: 2 x 2
  Trait     meanAcc
* &lt;chr&gt;       &lt;dbl&gt;
1 biofortSI    0.55
2 stdSI        0.42</code></pre>
<p>Perhaps indicating that the cross-mean dominates the prediction of UC, and in contrast to predictions of cross variances, the mean UC for the biofortSI was higher (0.55) compared to the stdSI (0.42).</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>accUC <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>,Stage <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Parent&quot;</span>,<span class="st">&quot;AYT&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,predOf,Trait,Stage) <span class="sc">%&gt;%</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">round</span>(<span class="fu">mean</span>(AccuracyWtCor),<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>predOf) <span class="sc">%&gt;%</span> </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Model,meanAcc) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">diffAcc=</span><span class="fu">ifelse</span>(Stage<span class="sc">==</span><span class="st">&quot;AYT&quot;</span>,AD<span class="sc">-</span>DirDomAD,A<span class="sc">-</span>DirDomBV))</span></code></pre></div>
<pre><code># A tibble: 4 x 7
  Trait     Stage      A    AD DirDomAD DirDomBV diffAcc
  &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 biofortSI AYT    NA     0.46     0.55    NA    -0.09  
2 biofortSI Parent  0.61 NA       NA        0.59  0.02  
3 stdSI     AYT    NA     0.44     0.48    NA    -0.0400
4 stdSI     Parent  0.39 NA       NA        0.37  0.02  </code></pre>
<p>For the biofortSI, the ClassicAD and DirDom models had nearly identical accuracy.</p>
<p>For the stdSI, however, accuracy was higher for the Classic AD model than for the DirDom model (by 0.07 <span class="math inline">\(UC_{parent}\)</span> and 0.09 <span class="math inline">\(UC_{clone}^{[AYT]}\)</span>).</p>
<p>The results above are for the PMV method of variance prediction, which we note give on average a 0.14 (0.41 vs. 0.55) lower accuracy estimate than VPM. As was the case with variance prediction accuracy, we did not observe qualitative differences between PMV and VPM.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>accUC <span class="sc">%&gt;%</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VarMethod) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">meanAcc=</span><span class="fu">mean</span>(AccuracyWtCor)) <span class="sc">%&gt;%</span> <span class="fu">spread</span>(VarMethod,meanAcc)</span></code></pre></div>
<pre><code># A tibble: 1 x 2
    PMV   VPM
  &lt;dbl&gt; &lt;dbl&gt;
1 0.491 0.568</code></pre>
</div>
<div id="population-estimates-of-additive-dominance-genetic-variance-covariances" class="section level1">
<h1>Population estimates of additive-dominance genetic variance-covariances</h1>
<p>In this study, our focus is mainly on distinguishing among crosses, and the accuracy of cross-metric predictions. Detailed analysis of the additive-dominance genetic variance-covariance structure in cassava (sub)-populations is an important topic, which we mostly leave for future study. However, we make a brief examination of the genetic variance-covariance estimates associated with the overall population and component genetic groups. We report all variance-covariance estimates in <strong>TableS15</strong> and complete BGLR output in the <a href="">repository associated with this study</a>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr);</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Table S15: Variance estimates for genetic groups</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>varcomps<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTables.xlsx&quot;</span>),<span class="at">sheet =</span> <span class="st">&quot;TableS15&quot;</span>)</span></code></pre></div>
<div id="justify-focus-on-pmv---m2-estimatess" class="section level2">
<h2>Justify focus on PMV - M2 estimatess</h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>varcomps <span class="sc">%&gt;%</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>propDom) <span class="sc">%&gt;%</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(VarA,VarD), <span class="at">names_to =</span> <span class="st">&quot;VarComp&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;VarEst&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(VarEst)) <span class="sc">%&gt;%</span> </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(VarMethod,VarEst) <span class="sc">%&gt;%</span> </span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">pmv_vpm=</span><span class="fu">c</span>(Trait1,Trait2,PMV,VPM)) <span class="sc">%&gt;%</span> </span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">corPMV_VPM=</span><span class="fu">map_dbl</span>(pmv_vpm,<span class="sc">~</span><span class="fu">cor</span>(.<span class="sc">$</span>PMV,.<span class="sc">$</span>VPM, <span class="at">use =</span> <span class="st">&#39;pairwise.complete.obs&#39;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pmv_vpm) <span class="sc">%$%</span> <span class="fu">summary</span>(corPMV_VPM)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.9374  0.9959  0.9980  0.9955  0.9991  1.0000 </code></pre>
<p>Close correspondence between VPM and PMV.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>varcomps <span class="sc">%&gt;%</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>propDom) <span class="sc">%&gt;%</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(VarA,VarD), <span class="at">names_to =</span> <span class="st">&quot;VarComp&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;VarEst&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(VarEst)) <span class="sc">%&gt;%</span> </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(VarMethod,VarEst) <span class="sc">%&gt;%</span> </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffVar=</span>PMV<span class="sc">-</span>VPM) <span class="sc">%$%</span> <span class="fu">summary</span>(diffVar)</span></code></pre></div>
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
 -0.70018  -0.01903   0.02228   8.85794   0.87596 179.66685 </code></pre>
<p>Difference in magnitude with PMV&gt;VPM, usually.</p>
<p>Focus on PMV estimates.</p>
<p>The functions for computing PMV estimates included in the <strong>predCrossVar</strong> package return “Method 2” (M2) variance estimates, which refers to variance accounting for LD (see Lehermeier et al. 2017a). The standard estimate is “Method 1” (M1) and is also included.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>varcomps <span class="sc">%&gt;%</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>VarMethod,<span class="sc">-</span>propDom) <span class="sc">%&gt;%</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(VarA,VarD), <span class="at">names_to =</span> <span class="st">&quot;VarComp&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;VarEst&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(VarEst),</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>         (Model<span class="sc">==</span><span class="st">&quot;AD&quot;</span> <span class="sc">|</span> Model<span class="sc">==</span><span class="st">&quot;DirDomAD&quot;</span>),</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>         Trait1<span class="sc">==</span>Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Method,VarEst) <span class="sc">%&gt;%</span> </span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">m1_m2=</span><span class="fu">c</span>(Trait1,Trait2,M2,M1)) <span class="sc">%&gt;%</span> </span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">corM1_M2=</span><span class="fu">map_dbl</span>(m1_m2,<span class="sc">~</span><span class="fu">cor</span>(.<span class="sc">$</span>M2,.<span class="sc">$</span>M1, <span class="at">use =</span> <span class="st">&#39;pairwise.complete.obs&#39;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>m1_m2) <span class="sc">%$%</span> <span class="fu">summary</span>(corM1_M2)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.9783  0.9968  0.9995  0.9966  1.0000  1.0000 </code></pre>
<p>The correlation between M1 and M2 estimates is very high, so we will focus on M2 estimates as they correspond to the predictions of within-cross variance.</p>
</div>
<div id="pop.-level-importance-add.-vs.-dom." class="section level2">
<h2>Pop.-level importance Add. vs. Dom.</h2>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr);</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Table S15: Variance estimates for genetic groups</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>varcomps<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTables.xlsx&quot;</span>),<span class="at">sheet =</span> <span class="st">&quot;TableS15&quot;</span>)</span></code></pre></div>
<p>Over all genetic groups analyzed, across trait and SI variances, dominance accounted for an average of 34% (range 7-68%) in the AD model, and 24% (6-53%) for the DirDom model.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>varcomps <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>, Method<span class="sc">==</span><span class="st">&quot;M2&quot;</span>,Model <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;AD&quot;</span>,<span class="st">&quot;DirDomAD&quot;</span>), Trait1<span class="sc">==</span>Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>VarMethod,<span class="sc">-</span>Method) <span class="sc">%&gt;%</span> </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model) <span class="sc">%&gt;%</span> </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">minPropDom=</span><span class="fu">min</span>(propDom),</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanPropDom=</span><span class="fu">mean</span>(propDom),</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxPropDom=</span><span class="fu">max</span>(propDom))</span></code></pre></div>
<pre><code># A tibble: 2 x 4
  Model    minPropDom meanPropDom maxPropDom
* &lt;chr&gt;         &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
1 AD             0.07       0.341       0.68
2 DirDomAD       0.06       0.236       0.53</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>varcomps <span class="sc">%&gt;%</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>, Method<span class="sc">==</span><span class="st">&quot;M2&quot;</span>,Model <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;AD&quot;</span>,<span class="st">&quot;DirDomAD&quot;</span>), Trait1<span class="sc">==</span>Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>VarMethod,<span class="sc">-</span>Method) <span class="sc">%&gt;%</span> </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait1,Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">minPropDom=</span><span class="fu">min</span>(propDom),</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanPropDom=</span><span class="fu">mean</span>(propDom),</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxPropDom=</span><span class="fu">max</span>(propDom)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(meanPropDom))</span></code></pre></div>
<pre><code># A tibble: 6 x 5
# Groups:   Trait1 [6]
  Trait1    Trait2    minPropDom meanPropDom maxPropDom
  &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
1 logFYLD   logFYLD         0.41       0.523       0.68
2 biofortSI biofortSI       0.18       0.322       0.53
3 stdSI     stdSI           0.14       0.297       0.53
4 MCMDS     MCMDS           0.08       0.239       0.47
5 DM        DM              0.11       0.222       0.32
6 TCHART    TCHART          0.06       0.129       0.33</code></pre>
<p>Across models (AD vs. DirDom), dominance was most important (mean 52% of genetic variance) for yield (logFYLD) and least important for DM (mean 22%) and TCHART (mean 13%) (Figure 4).</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>varcomps <span class="sc">%&gt;%</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>, Method<span class="sc">==</span><span class="st">&quot;M2&quot;</span>,Model <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;AD&quot;</span>,<span class="st">&quot;DirDomAD&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Trait1<span class="sc">!=</span>Trait2,<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;SI&quot;</span>,Trait1)) <span class="sc">%&gt;%</span>  </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait1,Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanPropDom=</span><span class="fu">mean</span>(propDom)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(meanPropDom))</span></code></pre></div>
<pre><code># A tibble: 6 x 3
# Groups:   Trait1 [3]
  Trait1  Trait2  meanPropDom
  &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt;
1 logFYLD TCHART        0.669
2 logFYLD MCMDS         0.462
3 DM      TCHART        0.049
4 DM      MCMDS        -0.016
5 MCMDS   TCHART       -0.071
6 DM      logFYLD      -1.39 </code></pre>
<p>For covariances, we observed that dominances were strongest (72% of genetic covariance) and in the same direction for logFYLD-MCMDS and was weakest for DM-TCHART (5%).</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>varcomps <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VarMethod<span class="sc">==</span><span class="st">&quot;PMV&quot;</span>, Method<span class="sc">==</span><span class="st">&quot;M2&quot;</span>,Model <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;AD&quot;</span>,<span class="st">&quot;DirDomAD&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Trait1<span class="sc">!=</span>Trait2,<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;SI&quot;</span>,Trait1)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">oppCovarDirection=</span><span class="fu">ifelse</span>(VarA<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> VarD<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">|</span> VarA<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> VarD<span class="sc">&gt;</span><span class="dv">0</span>,<span class="cn">TRUE</span>,<span class="cn">FALSE</span>),</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">CovarDiff=</span>VarA<span class="sc">-</span>VarD) <span class="sc">%&gt;%</span> </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(oppCovarDirection<span class="sc">==</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(CovarDiff)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait1,Trait2) <span class="sc">%&gt;%</span> </span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanCovarA=</span><span class="fu">mean</span>(VarA),</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanCovarD=</span><span class="fu">mean</span>(VarD))</span></code></pre></div>
<pre><code># A tibble: 5 x 4
# Groups:   Trait1 [3]
  Trait1  Trait2  meanCovarA meanCovarD
  &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;
1 DM      logFYLD   -0.110      0.0549 
2 DM      MCMDS      0.200     -0.117  
3 DM      TCHART    -0.480      0.00474
4 logFYLD TCHART    -0.0101     0.00336
5 MCMDS   TCHART    -0.00176    0.00170</code></pre>
<p>For several covariance estimates, there was an opposing sign of the estimate between dominance and additive components. For DM-logFYLD there was a tendency for positive dominance but negative additive covariance. For DM-MCMDS, in contrast, the tendency was for negative dominance but positive additive covariance.</p>
</div>
<div id="pop.-level-estimates-of-inbreeding-effects" class="section level2">
<h2>Pop.-level estimates of inbreeding effects</h2>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Table S16: Directional dominance effects estimates</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>ddEffects<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTables.xlsx&quot;</span>),<span class="at">sheet =</span> <span class="st">&quot;TableS16&quot;</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>ddEffects <span class="sc">%&gt;%</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Repeat,<span class="sc">-</span>Fold,<span class="sc">-</span>InbreedingEffectSD) <span class="sc">%&gt;%</span> </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dataset=</span><span class="fu">ifelse</span>(Dataset<span class="sc">!=</span><span class="st">&quot;GeneticGroups&quot;</span>,Group,Dataset)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Group) <span class="sc">%&gt;%</span> </span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Dataset,Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_all</span>(<span class="sc">~</span><span class="fu">round</span>(<span class="fu">mean</span>(.),<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Dataset,InbreedingEffect)</span></code></pre></div>
<pre><code># A tibble: 4 x 3
  Trait   GeneticGroups ParentwiseCV
  &lt;chr&gt;           &lt;dbl&gt;        &lt;dbl&gt;
1 DM             -4.82        -7.85 
2 logFYLD        -2.75        -3.88 
3 MCMDS           0.32         1.27 
4 TCHART         -0.004       -0.015</code></pre>
<p>We found mostly consistent and significant (diff. from zero) effects of inbreeding <em>depression</em> associated especially (<strong>Figure 5</strong>, <strong>Table S16</strong>), with logFYLD (mean effect -2.75 across genetic groups, -3.88 across cross-validation folds), but also DM (-4.82 genetic groups, -7.85 cross-validation) and MCMDS (0.32 genetic groups, 1.27 cross-validation). This corresponds to higher homozygosity being associated with lower DM, lower yield and worse disease.</p>
</div>
</div>
<div id="exploring-untested-crosses" class="section level1">
<h1>Exploring Untested Crosses</h1>
<p>We made 16 predictions (2 SIs x 2 prediction models [ClassicAD, DirDomAD] x 2 variance components [BV, TGV] x 2 criteria [Mean, UC = Mean + 2*SD]) prediction for each of 47,083 possible crosses of 306 parents.</p>
<div id="correlations-among-predictions" class="section level2">
<h2>Correlations among predictions</h2>
<p>First, quickly evaluate the multivariate decision space encompassed by predictions of mean, SD, UC for BV and TGV, ClassicAD vs. DirDomAD.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr); </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTable18.csv&quot;</span>),<span class="at">stringsAsFactors =</span> F)</span></code></pre></div>
<p><strong>TABLE:</strong> Correlations between predictions about each selection index (<span class="math inline">\(\overset{StdSI,BiofortSI}{\textbf{cor}}\)</span>).</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses <span class="sc">%&gt;%</span> </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Trait,Pred) <span class="sc">%&gt;%</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Model,PredOf,Component) <span class="sc">%&gt;%</span> </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corSelIndices=</span><span class="fu">cor</span>(stdSI,biofortSI)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Component,corSelIndices) <span class="sc">%&gt;%</span> </span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Model,PredOf) <span class="sc">%&gt;%</span> </span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["PredOf"],"name":[2],"type":["chr"],"align":["left"]},{"label":["BV"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["TGV"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"ClassicAD","2":"Mean","3":"0.1889975","4":"0.14212055"},{"1":"ClassicAD","2":"Sd","3":"0.8938597","4":"0.93464673"},{"1":"ClassicAD","2":"UC","3":"0.1110683","4":"0.07942013"},{"1":"DirDom","2":"Mean","3":"0.2202287","4":"0.18825945"},{"1":"DirDom","2":"Sd","3":"0.8825580","4":"0.94203309"},{"1":"DirDom","2":"UC","3":"0.1640598","4":"0.10805541"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Average correlations between BiofortSI and StdSI by prediction.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses <span class="sc">%&gt;%</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Trait,Pred) <span class="sc">%&gt;%</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PredOf,Model,Component) <span class="sc">%&gt;%</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corSelIndices=</span><span class="fu">cor</span>(stdSI,biofortSI)) <span class="sc">%&gt;%</span> </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PredOf) <span class="sc">%&gt;%</span> </span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanCorSIs=</span><span class="fu">mean</span>(corSelIndices))</span></code></pre></div>
<pre><code># A tibble: 3 x 2
  PredOf meanCorSIs
* &lt;chr&gt;       &lt;dbl&gt;
1 Mean        0.185
2 Sd          0.913
3 UC          0.116</code></pre>
<p><strong>TABLE:</strong> Correlations between predictions about each prediction model, within trait (<span class="math inline">\(\overset{ClassicAD,DirDomAD}{\textbf{cor}}\)</span>).</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses <span class="sc">%&gt;%</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Model,Pred) <span class="sc">%&gt;%</span> </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait,PredOf,Component) <span class="sc">%&gt;%</span> </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corModels=</span><span class="fu">round</span>(<span class="fu">cor</span>(ClassicAD,DirDom),<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Component,corModels) <span class="sc">%&gt;%</span> </span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Trait,PredOf) <span class="sc">%&gt;%</span> </span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Trait"],"name":[1],"type":["chr"],"align":["left"]},{"label":["PredOf"],"name":[2],"type":["chr"],"align":["left"]},{"label":["BV"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["TGV"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"biofortSI","2":"Mean","3":"0.99","4":"0.96"},{"1":"biofortSI","2":"Sd","3":"0.96","4":"0.99"},{"1":"biofortSI","2":"UC","3":"0.99","4":"0.96"},{"1":"stdSI","2":"Mean","3":"0.99","4":"0.94"},{"1":"stdSI","2":"Sd","3":"0.92","4":"0.99"},{"1":"stdSI","2":"UC","3":"0.99","4":"0.94"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Average correlations between ClassicAD and DirDomAD by prediction.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses <span class="sc">%&gt;%</span> </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Model,Pred) <span class="sc">%&gt;%</span> </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait,PredOf,Component) <span class="sc">%&gt;%</span> </span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corModels=</span><span class="fu">round</span>(<span class="fu">cor</span>(ClassicAD,DirDom),<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PredOf) <span class="sc">%&gt;%</span> </span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanCorModels=</span><span class="fu">mean</span>(corModels))</span></code></pre></div>
<pre><code># A tibble: 3 x 2
  PredOf meanCorModels
* &lt;chr&gt;          &lt;dbl&gt;
1 Mean           0.97 
2 Sd             0.965
3 UC             0.97 </code></pre>
<p><strong>TABLE:</strong> Correlations between predictions about each component, within trait (<span class="math inline">\(\overset{BV,TGV}{\textbf{cor}}\)</span>).</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses <span class="sc">%&gt;%</span> </span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Component,Pred) <span class="sc">%&gt;%</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait,Model,PredOf) <span class="sc">%&gt;%</span> </span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corComponents=</span><span class="fu">round</span>(<span class="fu">cor</span>(BV,TGV),<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Model,corComponents) <span class="sc">%&gt;%</span> </span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Trait,PredOf) <span class="sc">%&gt;%</span> </span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Trait"],"name":[1],"type":["chr"],"align":["left"]},{"label":["PredOf"],"name":[2],"type":["chr"],"align":["left"]},{"label":["ClassicAD"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["DirDom"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"biofortSI","2":"Mean","3":"0.88","4":"0.96"},{"1":"biofortSI","2":"Sd","3":"0.98","4":"0.91"},{"1":"biofortSI","2":"UC","3":"0.88","4":"0.95"},{"1":"stdSI","2":"Mean","3":"0.86","4":"0.95"},{"1":"stdSI","2":"Sd","3":"0.98","4":"0.88"},{"1":"stdSI","2":"UC","3":"0.84","4":"0.93"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses <span class="sc">%&gt;%</span> </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Component,Pred) <span class="sc">%&gt;%</span> </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait,Model,PredOf) <span class="sc">%&gt;%</span> </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corComponents=</span><span class="fu">round</span>(<span class="fu">cor</span>(BV,TGV),<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PredOf) <span class="sc">%&gt;%</span> </span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanCorBV_TGV=</span><span class="fu">mean</span>(corComponents))</span></code></pre></div>
<pre><code># A tibble: 3 x 2
  PredOf meanCorBV_TGV
* &lt;chr&gt;          &lt;dbl&gt;
1 Mean           0.912
2 Sd             0.938
3 UC             0.9  </code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses <span class="sc">%&gt;%</span> </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Component,Pred) <span class="sc">%&gt;%</span> </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait,Model,PredOf) <span class="sc">%&gt;%</span> </span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corComponents=</span><span class="fu">round</span>(<span class="fu">cor</span>(BV,TGV),<span class="dv">2</span>)) <span class="sc">%$%</span> <span class="fu">summary</span>(corComponents) </span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.8400  0.8800  0.9200  0.9167  0.9525  0.9800 </code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses <span class="sc">%&gt;%</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(PredOf,Pred) <span class="sc">%&gt;%</span> </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait,Model,Component) <span class="sc">%&gt;%</span> </span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corMeanSD=</span><span class="fu">round</span>(<span class="fu">cor</span>(Mean,Sd),<span class="dv">2</span>),</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">corMeanUC=</span><span class="fu">round</span>(<span class="fu">cor</span>(Mean,UC),<span class="dv">2</span>),</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">corSdUC=</span><span class="fu">round</span>(<span class="fu">cor</span>(Sd,UC),<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Trait"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Component"],"name":[3],"type":["chr"],"align":["left"]},{"label":["corMeanSD"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["corMeanUC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["corSdUC"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"biofortSI","2":"ClassicAD","3":"BV","4":"-0.27","5":"0.99","6":"-0.17"},{"1":"biofortSI","2":"ClassicAD","3":"TGV","4":"-0.23","5":"0.99","6":"-0.11"},{"1":"biofortSI","2":"DirDom","3":"BV","4":"-0.23","5":"1.00","6":"-0.13"},{"1":"biofortSI","2":"DirDom","3":"TGV","4":"-0.28","5":"0.99","6":"-0.16"},{"1":"stdSI","2":"ClassicAD","3":"BV","4":"-0.53","5":"0.99","6":"-0.43"},{"1":"stdSI","2":"ClassicAD","3":"TGV","4":"-0.39","5":"0.99","6":"-0.24"},{"1":"stdSI","2":"DirDom","3":"BV","4":"-0.48","5":"1.00","6":"-0.40"},{"1":"stdSI","2":"DirDom","3":"TGV","4":"-0.47","5":"0.99","6":"-0.34"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses <span class="sc">%&gt;%</span> </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(PredOf,Pred) <span class="sc">%&gt;%</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait,Model,Component) <span class="sc">%&gt;%</span> </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">corMeanSD=</span><span class="fu">round</span>(<span class="fu">cor</span>(Mean,Sd),<span class="dv">2</span>),</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">corMeanUC=</span><span class="fu">round</span>(<span class="fu">cor</span>(Mean,UC),<span class="dv">2</span>),</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">corSdUC=</span><span class="fu">round</span>(<span class="fu">cor</span>(Sd,UC),<span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="fu">across</span>(is.numeric,mean))<span class="co">#corComponents=round(cor(BV,TGV),2)) %$% summary(corComponents) </span></span></code></pre></div>
<pre><code># A tibble: 1 x 3
  corMeanSD corMeanUC corSdUC
      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1     -0.36     0.992  -0.248</code></pre>
<p>The mean and variance have a low, but negative correlation. At the standardized intensity of 2.67 (1% selected), leads to a small negative correlation between SD and UC. The crosses with highest mean will mostly be those with highest UC. The crosses with highest mean will also have a small tendency to have smaller variance.</p>
<p>Nevertheless, the <strong>biggest differences</strong> in decision space have to do with the difference between using the Mean vs. including the SD via the UC.</p>
<p><strong>Figure S14: Correlation matrix for predictions on the StdSI</strong></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>forCorrMat<span class="ot">&lt;-</span>predUntestedCrosses <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Family=</span><span class="fu">paste0</span>(sireID,<span class="st">&quot;x&quot;</span>,damID),</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">PredOf=</span><span class="fu">paste0</span>(Trait,<span class="st">&quot;_&quot;</span>,PredOf,<span class="st">&quot;_&quot;</span>,Component,<span class="st">&quot;_&quot;</span>,<span class="fu">ifelse</span>(Model<span class="sc">==</span><span class="st">&quot;ClassicAD&quot;</span>,<span class="st">&quot;classic&quot;</span>,<span class="st">&quot;dirdom&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Family,PredOf,Pred) <span class="sc">%&gt;%</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(PredOf,Pred)</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>corMat_std<span class="ot">&lt;-</span><span class="fu">cor</span>(forCorrMat[,<span class="fu">grepl</span>(<span class="st">&quot;stdSI&quot;</span>,<span class="fu">colnames</span>(forCorrMat))],<span class="at">use =</span> <span class="st">&#39;pairwise.complete.obs&#39;</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(corMat_std, <span class="at">type =</span> <span class="st">&#39;lower&#39;</span>, <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">10</span>), <span class="at">diag =</span> F,<span class="at">addCoef.col =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.srt =</span> <span class="dv">15</span>, <span class="at">tl.offset =</span> <span class="dv">1</span>,<span class="at">tl.col =</span> <span class="st">&#39;darkred&#39;</span>) </span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-71-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-71-1">
Past versions of unnamed-chunk-71-1.png
</button>
</p>
<div id="fig-unnamed-chunk-71-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-71-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Figure S15: Correlation matrix for predictions on the BiofortSI</strong></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>corMat_bio<span class="ot">&lt;-</span><span class="fu">cor</span>(forCorrMat[,<span class="fu">grepl</span>(<span class="st">&quot;biofortSI&quot;</span>,<span class="fu">colnames</span>(forCorrMat))],<span class="at">use =</span> <span class="st">&#39;pairwise.complete.obs&#39;</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(corMat_bio, <span class="at">type =</span> <span class="st">&#39;lower&#39;</span>, <span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">10</span>), <span class="at">diag =</span> F,<span class="at">addCoef.col =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.srt =</span> <span class="dv">15</span>, <span class="at">tl.offset =</span> <span class="dv">1</span>,<span class="at">tl.col =</span> <span class="st">&#39;darkred&#39;</span>) </span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-72-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-72-1">
Past versions of unnamed-chunk-72-1.png
</button>
</p>
<div id="fig-unnamed-chunk-72-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-72-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="decision-space---top-50-crosses" class="section level2">
<h2>Decision space - top 50 crosses?</h2>
<p>What we next want to know, is how different the selections of crosses-to-make would be if we use different criteria, particularly the mean vs. the UC.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr); <span class="fu">library</span>(ggforce)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTable18.csv&quot;</span>),<span class="at">stringsAsFactors =</span> F)</span></code></pre></div>
<p>For each of the 16 predictions of 47,083 crosses, select the top 50 ranked crosses.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>top50crosses<span class="ot">&lt;-</span>predUntestedCrosses <span class="sc">%&gt;%</span> </span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PredOf<span class="sc">!=</span><span class="st">&quot;Sd&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait,Model,PredOf,Component) <span class="sc">%&gt;%</span> </span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> Pred,<span class="at">n=</span><span class="dv">50</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(sireID,damID) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>[1] 310</code></pre>
<p>Number of distinct crosses selected per Trait</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Trait,sireID,damID) <span class="sc">%&gt;%</span> </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Trait)</span></code></pre></div>
<pre><code># A tibble: 2 x 2
  Trait         n
* &lt;chr&gt;     &lt;int&gt;
1 biofortSI   120
2 stdSI       190</code></pre>
<p>Number of Self vs. Outcross selected by Trait</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Trait,sireID,damID,IsSelf) <span class="sc">%&gt;%</span> </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Trait,IsSelf)</span></code></pre></div>
<pre><code># A tibble: 4 x 3
  Trait     IsSelf     n
  &lt;chr&gt;     &lt;lgl&gt;  &lt;int&gt;
1 biofortSI FALSE    113
2 biofortSI TRUE       7
3 stdSI     FALSE    183
4 stdSI     TRUE       7</code></pre>
<p>Only 310 unique crosses selected based on at least one of the 16 criteria. Of those 190 were selected for the StdSI (120 Biofort) including 7 (7) selfs on the StdSI (BiofortSI).</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Trait,sireID,damID) <span class="sc">%&gt;%</span> </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Selected=</span><span class="st">&quot;Yes&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Trait,Selected) <span class="sc">%&gt;%</span> </span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(.)</span></code></pre></div>
<pre><code># A tibble: 0 x 4
# … with 4 variables: sireID &lt;chr&gt;, damID &lt;chr&gt;, biofortSI &lt;chr&gt;, stdSI &lt;chr&gt;</code></pre>
<p>There were 0 crosses selected for both SI, all of which were selfs.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(CrossPrevMade,sireID,damID) <span class="sc">%&gt;%</span> </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(CrossPrevMade)</span></code></pre></div>
<pre><code># A tibble: 1 x 2
  CrossPrevMade     n
* &lt;chr&gt;         &lt;int&gt;
1 No              310</code></pre>
<p>None of the selected crosses have previously been tested.</p>
<p><strong>Table:</strong> Summarize, by trait, the number of and relative contributions (number of matings) proposed for each parent selected in the group of top crosses.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Family=</span><span class="fu">paste0</span>(sireID,<span class="st">&quot;x&quot;</span>,damID)) <span class="sc">%&gt;%</span> </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Trait,Family,sireID,damID) <span class="sc">%&gt;%</span> </span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(sireID,damID), <span class="at">names_to =</span> <span class="st">&quot;Parent&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;germplasmName&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Trait,germplasmName) <span class="sc">%&gt;%</span> </span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Nparents=</span><span class="fu">length</span>(<span class="fu">unique</span>(germplasmName)),</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">minProg=</span><span class="fu">min</span>(n),<span class="at">maxProg=</span><span class="fu">max</span>(n),<span class="at">medianProg=</span><span class="fu">median</span>(n))</span></code></pre></div>
<pre><code># A tibble: 2 x 5
  Trait     Nparents minProg maxProg medianProg
* &lt;chr&gt;        &lt;int&gt;   &lt;int&gt;   &lt;int&gt;      &lt;dbl&gt;
1 biofortSI       42       1     149          5
2 stdSI           87       1     169          3</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Family=</span><span class="fu">paste0</span>(sireID,<span class="st">&quot;x&quot;</span>,damID)) <span class="sc">%&gt;%</span> </span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Trait,Family,sireID,damID) <span class="sc">%&gt;%</span> </span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(sireID,damID), <span class="at">names_to =</span> <span class="st">&quot;Parent&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;germplasmName&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Trait,germplasmName) <span class="sc">%&gt;%</span> </span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait) <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(n)</span></code></pre></div>
<pre><code># A tibble: 2 x 3
# Groups:   Trait [2]
  Trait     germplasmName          n
  &lt;chr&gt;     &lt;chr&gt;              &lt;int&gt;
1 biofortSI IITA-TMS-IBA011371   149
2 stdSI     TMS13F1095P0013      169</code></pre>
<p>There were 96 parents represented among the 221 “best” crosses for StdSI with an median usage in 5 families (range 1-91, most popular parent = <strong>TMS13F1095P0013</strong>). Only 51 parents were indicated for the BiofortSI with a median contribution to 4 (range 1-116, most popular parent = <strong>IITA-TMS-IBA011371</strong>) crosses.</p>
<p><strong>Next:</strong> For each SI, break down the criteria for which the “best” crosses are interesting.</p>
<p>Quantify the number of unique crosses selected by:</p>
<p><strong>1. Model (ClassicAD vs. DirDomAD)</strong> * The ClassicAD model selects only a few selfs for their mean, but does by the UC. * The DirDomAD model, in contrast, selects exclusively selfs for UC_TGV and not only because of high predicted mean. * Crosses selected by ClassicAD, DirDomAD vs. Both?</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Trait,sireID,damID,IsSelf,Model) <span class="sc">%&gt;%</span> </span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Selected=</span><span class="st">&quot;Yes&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Model,Selected) <span class="sc">%&gt;%</span> </span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(),replace_na,<span class="at">replace =</span> <span class="st">&quot;No&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Trait,IsSelf,ClassicAD,DirDom) <span class="sc">%&gt;%</span> </span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(IsSelf,n,<span class="at">sep =</span> <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Trait"],"name":[1],"type":["chr"],"align":["left"]},{"label":["ClassicAD"],"name":[2],"type":["chr"],"align":["left"]},{"label":["DirDom"],"name":[3],"type":["chr"],"align":["left"]},{"label":["IsSelfFALSE"],"name":[4],"type":["int"],"align":["right"]},{"label":["IsSelfTRUE"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"biofortSI","2":"No","3":"Yes","4":"19","5":"NA"},{"1":"biofortSI","2":"Yes","3":"No","4":"29","5":"1"},{"1":"biofortSI","2":"Yes","3":"Yes","4":"65","5":"6"},{"1":"stdSI","2":"No","3":"Yes","4":"56","5":"4"},{"1":"stdSI","2":"Yes","3":"No","4":"78","5":"NA"},{"1":"stdSI","2":"Yes","3":"Yes","4":"49","5":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>For the StdSI 29 crosses selected by both, 109 and 83 unique to ClassicAD and DirDomAD respectively. For the BiofortSI 66 crosses selected by both models, 41 and 28 unique to ClassicAD and DirDomAD respectively.</p>
<p>Most of the selfs chosen, were chosen by the DirDomAD predictions; 59% of 70 selected StdSI selfs were uniquely chosen by the DirDomAD model (35% of 34 BiofortSI selfs).</p>
<p>Selfs selected by ClassicAD were mostly chosen based on the UC (and thus their predicted variance). In contrast, the DirDomAD model selected selfs having a high means <em>and</em> variances.</p>
<p><strong>2. Component (BV vs. TGV)</strong> * Not many crosses are selected for both their BV <em>and</em> TGV? * Selfs get selected mostly by TGV???</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Trait,sireID,damID,IsSelf,Component,PredOf) <span class="sc">%&gt;%</span> </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Selected=</span><span class="st">&quot;Yes&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Component,Selected) <span class="sc">%&gt;%</span> </span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(),replace_na,<span class="at">replace =</span> <span class="st">&quot;No&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Trait,IsSelf,BV,TGV) <span class="sc">%&gt;%</span> </span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(IsSelf,n,<span class="at">sep =</span> <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Trait"],"name":[1],"type":["chr"],"align":["left"]},{"label":["BV"],"name":[2],"type":["chr"],"align":["left"]},{"label":["TGV"],"name":[3],"type":["chr"],"align":["left"]},{"label":["IsSelfFALSE"],"name":[4],"type":["int"],"align":["right"]},{"label":["IsSelfTRUE"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"biofortSI","2":"No","3":"Yes","4":"81","5":"NA"},{"1":"biofortSI","2":"Yes","3":"No","4":"56","5":"13"},{"1":"biofortSI","2":"Yes","3":"Yes","4":"59","5":"NA"},{"1":"stdSI","2":"No","3":"Yes","4":"135","5":"NA"},{"1":"stdSI","2":"Yes","3":"No","4":"110","5":"11"},{"1":"stdSI","2":"Yes","3":"Yes","4":"39","5":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Most selfs were selected either based on TGV.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Trait,sireID,damID,Component) <span class="sc">%&gt;%</span> </span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Selected=</span><span class="st">&quot;Yes&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Component,Selected) <span class="sc">%&gt;%</span> </span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(),replace_na,<span class="at">replace =</span> <span class="st">&quot;No&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Trait,BV,TGV) <span class="sc">%&gt;%</span>        </span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Trait"],"name":[1],"type":["chr"],"align":["left"]},{"label":["BV"],"name":[2],"type":["chr"],"align":["left"]},{"label":["TGV"],"name":[3],"type":["chr"],"align":["left"]},{"label":["n"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"biofortSI","2":"No","3":"Yes","4":"44"},{"1":"biofortSI","2":"Yes","3":"No","4":"39"},{"1":"biofortSI","2":"Yes","3":"Yes","4":"37"},{"1":"stdSI","2":"No","3":"Yes","4":"89"},{"1":"stdSI","2":"Yes","3":"No","4":"78"},{"1":"stdSI","2":"Yes","3":"Yes","4":"23"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Only 23 of 190 (StdSI) and 37 of 120 crosses (BiofortSI) were selected for both BV and TGV.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the number of parents unique selected based on BV vs. TGV</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">families=</span><span class="fu">c</span>(<span class="sc">-</span>Trait,<span class="sc">-</span>Component)) <span class="sc">%&gt;%</span> </span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Component,families) <span class="sc">%&gt;%</span> </span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NparentsBVunique=</span><span class="fu">map2_dbl</span>(BV,TGV,<span class="sc">~</span><span class="fu">length</span>(<span class="fu">union</span>(.x<span class="sc">$</span>sireID,.x<span class="sc">$</span>damID) <span class="sc">%&gt;%</span> .[<span class="sc">!</span>. <span class="sc">%in%</span> <span class="fu">union</span>(.y<span class="sc">$</span>sireID,.y<span class="sc">$</span>damID)])),</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">NparentsTGVunique=</span><span class="fu">map2_dbl</span>(BV,TGV,<span class="sc">~</span><span class="fu">length</span>(<span class="fu">union</span>(.y<span class="sc">$</span>sireID,.y<span class="sc">$</span>damID) <span class="sc">%&gt;%</span> .[<span class="sc">!</span>. <span class="sc">%in%</span> <span class="fu">union</span>(.x<span class="sc">$</span>sireID,.x<span class="sc">$</span>damID)])),</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">NparentsTot=</span><span class="fu">map2_dbl</span>(BV,TGV,<span class="sc">~</span><span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">c</span>(.x<span class="sc">$</span>sireID,.x<span class="sc">$</span>damID,.y<span class="sc">$</span>sireID,.y<span class="sc">$</span>damID))))) <span class="sc">%&gt;%</span> </span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>BV,<span class="sc">-</span>TGV) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Trait) <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Trait"],"name":[1],"type":["chr"],"align":["left"]},{"label":["NparentsBVunique"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["NparentsTGVunique"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["NparentsTot"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"biofortSI","2":"0","3":"23","4":"42"},{"1":"stdSI","2":"26","3":"28","4":"87"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the number of parents unique selected based on BV vs. TGV</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">families=</span><span class="fu">c</span>(<span class="sc">-</span>Trait,<span class="sc">-</span>Component,<span class="sc">-</span>Model)) <span class="sc">%&gt;%</span> </span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Component,families) <span class="sc">%&gt;%</span> </span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NparentsBVunique=</span><span class="fu">map2_dbl</span>(BV,TGV,<span class="sc">~</span><span class="fu">length</span>(<span class="fu">union</span>(.x<span class="sc">$</span>sireID,.x<span class="sc">$</span>damID) <span class="sc">%&gt;%</span> .[<span class="sc">!</span>. <span class="sc">%in%</span> <span class="fu">union</span>(.y<span class="sc">$</span>sireID,.y<span class="sc">$</span>damID)])),</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">NparentsTGVunique=</span><span class="fu">map2_dbl</span>(BV,TGV,<span class="sc">~</span><span class="fu">length</span>(<span class="fu">union</span>(.y<span class="sc">$</span>sireID,.y<span class="sc">$</span>damID) <span class="sc">%&gt;%</span> .[<span class="sc">!</span>. <span class="sc">%in%</span> <span class="fu">union</span>(.x<span class="sc">$</span>sireID,.x<span class="sc">$</span>damID)])),</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">NparentsTot=</span><span class="fu">map2_dbl</span>(BV,TGV,<span class="sc">~</span><span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">c</span>(.x<span class="sc">$</span>sireID,.x<span class="sc">$</span>damID,.y<span class="sc">$</span>sireID,.y<span class="sc">$</span>damID))))) <span class="sc">%&gt;%</span> </span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>BV,<span class="sc">-</span>TGV) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Trait,Model) <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Trait"],"name":[2],"type":["chr"],"align":["left"]},{"label":["NparentsBVunique"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["NparentsTGVunique"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["NparentsTot"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"ClassicAD","2":"biofortSI","3":"3","4":"22","5":"39"},{"1":"DirDom","2":"biofortSI","3":"1","4":"14","5":"33"},{"1":"ClassicAD","2":"stdSI","3":"36","4":"26","5":"85"},{"1":"DirDom","2":"stdSI","3":"4","4":"22","5":"44"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Mean vs. UC
<ul>
<li>Again, there are crosses selected by Mean, UC and both</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Trait,sireID,damID,PredOf) <span class="sc">%&gt;%</span> </span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Selected=</span><span class="st">&quot;Yes&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(PredOf,Selected) <span class="sc">%&gt;%</span> </span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(),replace_na,<span class="at">replace =</span> <span class="st">&quot;No&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Trait,Mean,UC) <span class="sc">%&gt;%</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Trait"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Mean"],"name":[2],"type":["chr"],"align":["left"]},{"label":["UC"],"name":[3],"type":["chr"],"align":["left"]},{"label":["n"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"biofortSI","2":"No","3":"Yes","4":"18"},{"1":"biofortSI","2":"Yes","3":"No","4":"13"},{"1":"biofortSI","2":"Yes","3":"Yes","4":"89"},{"1":"stdSI","2":"No","3":"Yes","4":"39"},{"1":"stdSI","2":"Yes","3":"No","4":"46"},{"1":"stdSI","2":"Yes","3":"Yes","4":"105"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>In fact, 28 of 87 parents selected on the StdSI were chosen only for the TGV of crosses and 26 only for BV (Figure 7). For the BiofortSI, no parents were chosen only for BV, but 23 of 42 were only interesting for their TGV.</p>
<p>Only 39 crosses for the StdSI (18 for BiofortSI) were selected only based on the UC (i.e. selected for their variance but not their mean).</p>
<p>So which are the “BEST” crosses? * Chosen most times, for most criteria?</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>best50crosses<span class="ot">&lt;-</span>top50crosses <span class="sc">%&gt;%</span> </span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sireID,damID,Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> <span class="st">`</span><span class="at">n</span><span class="st">`</span>,<span class="at">n =</span> <span class="dv">50</span>, <span class="at">with_ties =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">NtimesChosen=</span>n) </span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>best50crosses <span class="sc">%&gt;%</span> <span class="fu">count</span>(Trait)</span></code></pre></div>
<pre><code># A tibble: 2 x 2
# Groups:   Trait [2]
  Trait         n
  &lt;chr&gt;     &lt;int&gt;
1 biofortSI    50
2 stdSI       112</code></pre>
<p>If you use the most times chosen as the criteria and you don’t break ties, there are 112 StdSI and 50 BiofortSI crosses to consider as the “best”.</p>
</div>
<div id="plot-relationship-between-pred.-mean-and-variances-on-stdsi" class="section level2">
<h2>Plot relationship between pred. mean and variances on StdSI</h2>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(magrittr); <span class="fu">library</span>(patchwork);</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce); <span class="fu">library</span>(concaveman); <span class="fu">library</span>(V8)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>predUntestedCrosses<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;manuscript&quot;</span>,<span class="st">&quot;SupplementaryTable18.csv&quot;</span>),<span class="at">stringsAsFactors =</span> F)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>preds_std<span class="ot">&lt;-</span>predUntestedCrosses <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait<span class="sc">==</span><span class="st">&quot;stdSI&quot;</span>)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>top50crosses_std<span class="ot">&lt;-</span>preds_std <span class="sc">%&gt;%</span> </span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PredOf<span class="sc">!=</span><span class="st">&quot;Sd&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait,Model,PredOf,Component) <span class="sc">%&gt;%</span> </span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> Pred,<span class="at">n=</span><span class="dv">50</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>forplot_std<span class="ot">&lt;-</span>preds_std <span class="sc">%&gt;%</span> </span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(PredOf,Pred) <span class="sc">%&gt;%</span> </span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CrossType=</span><span class="fu">ifelse</span>(IsSelf<span class="sc">==</span><span class="cn">TRUE</span>,<span class="st">&quot;SelfCross&quot;</span>,<span class="st">&quot;Outcross&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(top50crosses_std <span class="sc">%&gt;%</span> </span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">distinct</span>(sireID,damID) <span class="sc">%&gt;%</span> </span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Group=</span><span class="st">&quot;NewCrosses&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group=</span><span class="fu">ifelse</span>(CrossPrevMade<span class="sc">==</span><span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;PreviousCrosses&quot;</span>,Group))</span></code></pre></div>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>meanVSvar<span class="ot">&lt;-</span>forplot_std <span class="sc">%&gt;%</span> </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Mean,<span class="at">y=</span>Sd,<span class="at">shape=</span>CrossType)) <span class="sc">+</span> </span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&#39;gray20&#39;</span>,<span class="at">size=</span><span class="fl">0.75</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>forplot_std <span class="sc">%&gt;%</span> </span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">filter</span>(Group<span class="sc">==</span><span class="st">&quot;NewCrosses&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">mutate</span>(<span class="co">#lab=&quot;Best New Crosses&quot;,</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">desc=</span><span class="fu">ifelse</span>(CrossType<span class="sc">==</span><span class="st">&quot;SelfCross&quot;</span>,<span class="st">&quot;New Selfs&quot;</span>,<span class="st">&quot;New Outcrosses&quot;</span>)),</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">fill=</span>Group,<span class="at">label=</span>desc), <span class="at">expand =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="st">&quot;mm&quot;</span>)) <span class="sc">+</span> <span class="co"># , label.buffer = unit(30, &#39;mm&#39;)) +</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> forplot_std <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Group),IsSelf<span class="sc">==</span><span class="cn">FALSE</span>),</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span>Mean,<span class="at">y=</span>Sd,<span class="at">fill=</span>Group), <span class="at">shape=</span><span class="dv">21</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>,<span class="at">inherit.aes =</span> F) <span class="sc">+</span> </span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> forplot_std <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Group),IsSelf<span class="sc">==</span><span class="cn">TRUE</span>),</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span>Mean,<span class="at">y=</span>Sd,<span class="at">fill=</span>Group), <span class="at">shape=</span><span class="dv">25</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>,<span class="at">inherit.aes =</span> F) <span class="sc">+</span> </span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;goldenrod2&quot;</span>,<span class="st">&quot;darkorchid4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Component<span class="sc">~</span>Model, <span class="at">scales=</span><span class="st">&#39;free&#39;</span>) <span class="sc">+</span> </span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>),</span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>),</span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb154-20"><a href="#cb154-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb154-21"><a href="#cb154-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">0</span>)) <span class="co">#       legend.position = &#39;none&#39;)</span></span>
<span id="cb154-22"><a href="#cb154-22" aria-hidden="true" tabindex="-1"></a>meanVSvar</span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-89-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-89-1">
Past versions of unnamed-chunk-89-1.png
</button>
</p>
<div id="fig-unnamed-chunk-89-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-89-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>forplot_std_bvVStgv<span class="ot">&lt;-</span>forplot_std <span class="sc">%&gt;%</span> </span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Mean,<span class="sc">-</span>Sd) <span class="sc">%&gt;%</span> </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Component,UC)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>bvVStgv<span class="ot">&lt;-</span>forplot_std_bvVStgv <span class="sc">%&gt;%</span> </span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>BV,<span class="at">y=</span>TGV,<span class="at">shape=</span>CrossType)) <span class="sc">+</span> </span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&#39;gray20&#39;</span>,<span class="at">size=</span><span class="fl">0.75</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&#39;darkred&#39;</span>) <span class="sc">+</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>forplot_std_bvVStgv <span class="sc">%&gt;%</span> </span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">filter</span>(Group<span class="sc">==</span><span class="st">&quot;NewCrosses&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">mutate</span>(<span class="at">lab=</span><span class="fu">ifelse</span>(CrossType<span class="sc">==</span><span class="st">&quot;SelfCross&quot;</span>,<span class="st">&quot;New Selfs&quot;</span>,<span class="st">&quot;New Outcrosses&quot;</span>)),</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">fill=</span>Group,<span class="at">label=</span>lab), <span class="at">expand =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="st">&quot;mm&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> forplot_std_bvVStgv <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Group),IsSelf<span class="sc">==</span><span class="cn">FALSE</span>),</span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span>BV,<span class="at">y=</span>TGV,<span class="at">fill=</span>Group), <span class="at">shape=</span><span class="dv">21</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>,<span class="at">inherit.aes =</span> F) <span class="sc">+</span> </span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> forplot_std_bvVStgv <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Group),IsSelf<span class="sc">==</span><span class="cn">TRUE</span>),</span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span>BV,<span class="at">y=</span>TGV,<span class="at">fill=</span>Group), <span class="at">shape=</span><span class="dv">25</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>,<span class="at">inherit.aes =</span> F) <span class="sc">+</span> </span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> </span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;goldenrod2&quot;</span>,<span class="st">&quot;darkorchid4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Model, <span class="at">scales=</span><span class="st">&#39;free&#39;</span>) <span class="sc">+</span> </span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">color=</span><span class="st">&#39;black&#39;</span>),</span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;bold&#39;</span>, <span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="st">&quot;UC&quot;</span>[<span class="st">&quot;parent&quot;</span>]<span class="sc">~</span><span class="st">&quot; (BV)&quot;</span>), <span class="at">y=</span><span class="fu">expression</span>(<span class="st">&quot;UC&quot;</span>[<span class="st">&quot;variety&quot;</span>]<span class="sc">~</span><span class="st">&quot; (TGV)&quot;</span>))</span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a>bvVStgv</span></code></pre></div>
<p><img src="figure/Results.Rmd/unnamed-chunk-90-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-90-1">
Past versions of unnamed-chunk-90-1.png
</button>
</p>
<div id="fig-unnamed-chunk-90-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/wolfemd/PredictOutbredCrossVar/blob/6a10c30fbe489268566e4b7568be67a4395c2080/docs/figure/Results.Rmd/unnamed-chunk-90-1.png" target="_blank">6a10c30</a>
</td>
<td>
wolfemd
</td>
<td>
2021-01-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<p><strong>Validation-data types (GBLUPs vs. i.i.d. BLUPs):</strong> Prediction accuracy using GBLUPs as validation gives a nearly uniformly higher correlation (mean 0.19 higher) as opposed to the i.i.d. BLUPs for family means (Figure S03, Figure S05, Table S10). Figure S04 illustrates that accuracies per trait-fold-rep-model do not re-rank much depending on whether GBLUPs or i.i.d. BLUPs were used as validation data. Given these results, we only consider accuracy based on GBLUPs in the comparisons below. As for the family means, we compared the estimates of variance-prediction accuracy obtained using GBLUPs versus i.i.d. BLUPs. Similar to the means, GBLUPs-as-validation data for variances led to higher estimates of accuracy on average (mean 0.073). We briefly explored the consequences of using GBLUPs vs. i.i.d. BLUPs as validation data. First, we found that there is re-ranking of accuracies between validation data-types (Figure S09). However, plotting the distributions of accuracies for variances (Figure S10A) and covariances (Figure S10B) suggests that we would reach similar but less strong conclusions about the difference between prediction models and variance components. Moreover, we would reach similar conclusions about which trait variances and trait-trait covariances are best or worst predicted. We thus consider for our primary conclusions, the prediction accuracy with GBLUP-derived validation data. Based on the i.i.d. BLUP for validation estimates, we noted that the accuracy predicting variance on the BiofortSI was negative (FiguresS09, FiguresS10), a fact which would preclude use for selection. Validation sample variance for a selection index, based on i.i.d. BLUPs sample size is limited relative to using GBLUPs because clones in each family must have observed BLUPs for each component trait or else the observed SI value cannot be computed.</p>
<p><strong>What difference does the weighted correlation make?</strong> For variances (but not means), we chose to weight prediction-observation pairs according to the number of family members (GBLUPs-as-validation) or the number of observed non-missing i.i.d. BLUPs per family per trait (i.i.d. BLUPs-as-validation) when computing prediction accuracies. The weighted correlations are justified because large families (or heavily phenotyped ones) should have better-estimated variances than small ones. Below, we consider briefly the effect weighted correlations have on results. We found that the weighted-vs-unweighted (WT vs. no WT) accuracies are themselves highly correlated (mean cor. 0.87) across traits, variance components, models and validation-data types. There was not a consistent increase or decrease in accuracy according to weighting. Across variance components, models, validation-data and var. methods (PMV vs. VPM), very close to mean 0 diff. between WT and no WT, but generally WT&gt;no WT. Conclusions appear to be at least qualitatively similar whether or not weighted correlations are considered as measures of accuracy (Figure S11).</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Catalina 10.15.7

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] V8_3.4.0           concaveman_1.1.0   ggforce_0.3.2.9000 patchwork_1.1.1   
 [5] magrittr_2.0.1     forcats_0.5.1      stringr_1.4.0      dplyr_1.0.3       
 [9] purrr_0.3.4        readr_1.4.0        tidyr_1.1.2        tibble_3.0.6      
[13] ggplot2_3.3.3      tidyverse_1.3.0   

loaded via a namespace (and not attached):
 [1] nlme_3.1-151       fs_1.5.0           lubridate_1.7.9.2  httr_1.4.2        
 [5] rprojroot_2.0.2    tools_4.0.2        backports_1.2.1    utf8_1.1.4        
 [9] R6_2.5.0           DBI_1.1.1          colorspace_2.0-0   withr_2.4.1       
[13] tidyselect_1.1.0   gridExtra_2.3      mnormt_2.0.2       curl_4.3          
[17] compiler_4.0.2     git2r_0.28.0       textshaping_0.2.1  cli_2.3.0         
[21] rvest_0.3.6        xml2_1.3.2         labeling_0.4.2     scales_1.1.1      
[25] psych_2.0.12       systemfonts_0.3.2  digest_0.6.27      rmarkdown_2.6     
[29] pkgconfig_2.0.3    htmltools_0.5.1.1  dbplyr_2.0.0       highr_0.8         
[33] rlang_0.4.10       readxl_1.3.1       rstudioapi_0.13    gridGraphics_0.5-1
[37] farver_2.0.3       generics_0.1.0     jsonlite_1.7.2     Rcpp_1.0.6        
[41] munsell_0.5.0      fansi_0.4.2        viridis_0.5.1      lifecycle_0.2.0   
[45] stringi_1.5.3      whisker_0.4        yaml_2.2.1         MASS_7.3-53       
[49] grid_4.0.2         parallel_4.0.2     promises_1.1.1     crayon_1.3.4      
[53] lattice_0.20-41    haven_2.3.1        hms_1.0.0          tmvnsim_1.0-2     
[57] knitr_1.31         ps_1.5.0           pillar_1.4.7       reprex_1.0.0      
[61] glue_1.4.2         evaluate_0.14      modelr_0.1.8       tweenr_1.0.1      
[65] vctrs_0.3.6        httpuv_1.5.5       cellranger_1.1.0   polyclip_1.10-0   
[69] gtable_0.3.0       assertthat_0.2.1   xfun_0.20          broom_0.7.4       
[73] later_1.1.0.1      ragg_0.4.1         viridisLite_0.3.0  workflowr_1.6.2   
[77] corrplot_0.84      ellipsis_0.3.1     here_1.0.1        </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
